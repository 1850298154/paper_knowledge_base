\begin{algorithm}[ht]
\caption{${\tt Expand\_\drrtstar(} \mmgimp, \tree, \vlast, T {\tt)}$}
\label{algo:drrtstar_expand}
\If{$\vlast == NULL$}
{
    $\qrand \gets {\tt Random\_Sample()}$\;
    $\vnear \gets {\tt Nearest\_Neighbor(} \tree, \qrand {\tt)}$\;
    $\vnew \gets {\tt \oracle (} \vnear, \qrand {\tt)}$\;
}
\Else
{
    $\vnew \gets {\tt \oracle (} \vlast, T {\tt)}$\;
}
$N \gets {\tt Adjacent(} \vnew, \mmgimp {\tt )} \cap \nodes_{\tree}$\;
$\vparent \gets \argmin_{v \in N s.t. \local(v, \vnew) \subset \cfree } c(v) + c( \local(v, \vnew )) $\;
\If{$\vparent == NULL$}
{
    ${\bf return}\ NULL$\;
}
\If{ $\vnew \notin \tree$ }
{
    $\tree.{\tt Add\_Vertex(} \vnew {\tt)}$\;
    $\tree.{\tt Add\_Edge(} \vparent, \vnew {\tt)}$\;
}
\Else
{
    $\tree.{\tt Rewire(} \vparent, \vnew {\tt)}$\;    
}
\For{ $v \in N$ }
{
    \If{ $c( \vnew ) + c( \local( \vnew, v ) < c( v )$ and $\local(\vnew, v) \subset \cfree$ }
    {
        $\tree.{\tt Rewire(} \vnew, v {\tt )}$\;
    }
}
\If{ $h(\vnew) < h(\vparent)$ }
{
  ${\bf return}\ \vnew$\;
}
\Else
{
    ${\bf return}\ NULL$\;
}
\end{algorithm}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../isrr"
%%% End:
