


\section{Existence of bad example that is biconnected}
\label{sec:biconnected}
We now show that the worst-case integrality gap for the subtour LP for the 1,2-TSP can be found on graphs of cost 1 edges that are biconnected.  Let $OPT(G)$ and $\SUBT(G)$ be the cost of the optimal tour and the value of the subtour LP (respectively) when $G$ is the graph of cost 1 edges.
We start by proving that the worst case is obtained on a connected graph.


\begin{lemma} \label{lem:12connect}
Let $G$ be the graph of cost 1 edges in a 1,2-TSP instance.  Then if $G$ is not connected, there exists a connected graph $G'$ such that $OPT(G)/\SUBT(G) \leq OPT(G')/\SUBT(G')$.
\end{lemma}

\begin{proof}
Suppose $G$ has more than one connected component. We create $G'=(V',E')$ by adding a new vertex $i^*$ to the graph, and adding edges from all $j \in V$ to $i^*$ so that $V' = V \cup \set{i^*}$ and $E' = E \cup \set{(i^*,j):  j \in V}$.  Given a tour of $G'$, we can easily produce a tour of $G$ of no greater cost by shortcutting $i^*$, so that $OPT(G) \leq OPT(G')$.  Let $x$ be an optimal solution to the subtour LP for the graph $G$.  We now define a solution $x'$ for $G'$, where $x'_{ij} = x_{ij}$ if $i$ and $j$ are in the same connected component of $G$, while if $i$ and $j$ are in different connected components of $G$, then we set $x'_{ij} = 0$, $x'_{i^*i}=x_{ij}$, and $x'_{i^*j} = x_{ij}$.  It is easy to see that the cost of $x'$ is the same as that of $x$.  We now argue that there is some solution $x''$ feasible for the subtour LP on $G'$ such that its cost is no greater, so that $\SUBT(G') \leq \SUBT(G)$.  It is clear that the bounds constraints (\ref{boundscons}) are satisfied for $x'$ and the degree constraints (\ref{degreecons}) are satisfied for $x'$ for all $i \in V$; however, the degree constraint for $i^*$ may not be satisfied.  Since for any component $C \subseteq V$ of $G$, $x(\delta(C)) \geq 2$, it is clear that $x'(\delta(i^*)) \geq 2$, but it may be the case that $x'(\delta(i^*)) > 2$.  For the subtour constraints (\ref{subtourcons}), consider any $S \subset V'$, $S \neq \emptyset$, such that $i^* \notin S$.  Then $x'(\delta(S)) \geq x(\delta(S)) \geq 2$, and for any $S \subseteq V'$ with $i^* \in S$, $S \neq \{i^*\}$, $x'(\delta(S)) = x'(\delta(V'-S)) \geq 2$ by the previous argument.  Finally, Goemans and Bertsimas~\cite{GoemansB90} have shown (see also Williamson~\cite{Williamson90}) that if edge costs obey the triangle inequality, and there is some solution $x'$ to the subtour LP in which degree constraints are exceeded but all other constraints are met, then there is another feasible solution $x''$ of no greater cost in which all constraints are satisfied.  Hence we have that $\SUBT(G') \leq \SUBT(G)$. Thus we have that $OPT(G)/\SUBT(G) \leq OPT(G')/\SUBT(G')$.
\mqed\end{proof}


\begin{lemma}\label{lem:12biconn}
Let $G$ be the graph of cost 1 edges in a 1,2-TSP instance.  Then if $G$ is not biconnected, there exists a biconnected $G'$ such that $OPT(G)/\SUBT(G) \leq OPT(G')/\SUBT(G')$.
\end{lemma}

\begin{proof}
By Lemma~\ref{lem:12connect}, we can assume that the graph $G=(V,E)$ is connected.  Let $i_1, \ldots, i_k$ be all the cut vertices of $G$, and let $C_1,\ldots, C_\ell$ be all the connected components formed when these vertices are removed, so that $C_1,\ldots,C_\ell, \set{i_1},\ldots, \set{i_k}$ form a partition of $V$.  We create a new graph $G'=(V',E')$ by adding a new vertex $i^*$, and adding edges from $i^*$ to each vertex in $C_1 \cup \cdots \cup C_\ell$, so that $V' = V \cup \set{i^*}$ and $E' = E \cup \set{(i^*,j): j \in C_p \mbox{ for some } p}$. We note that $G'$ is biconnected. As before, we have $OPT(G) \leq OPT(G')$ since given a tour of $G'$ we can shortcut $i^*$ to get a tour of $G$.  Let $x$ be an optimal subtour LP solution for graph $G$.  We now argue, as we did in the proof of Lemma~\ref{lem:12connect}, that we can create an $x'$ that costs no more than $x$ such that all the subtour and bounds constraints are obeyed, and all degree constraints are either met or exceeded; this will imply that $\SUBT(G') \leq \SUBT(G)$, and complete the proof.  Suppose without loss of generality that removing cut vertex $i_1$ creates components $C_1$ and $C = C_2 \cup \cdots \cup C_\ell \cup \set{i_2} \cup \cdots \cup \set{i_k}$, so that $C_1$, $\set{i_1}$, and $C$ partition $V$.  We set $x'_{ij} = 0$ and $x'_{i^*i}=x'_{i^*j}=x_{ij}$ if $i \in C_1$ and $j \in C$; $x'_{ij} = x_{ij}$ otherwise.  If $i \in C_1$ and $j \in C$, then $(i,j) \notin E$ since $i_1$ is a cut vertex, so the cost of $x'$ is no more than that of $x$.  The arguments that all constraints are satisfied except for the degree constraint on $i^*$ follow as in the proof of Lemma~\ref{lem:12connect}.  We now must argue that $x'(\delta(i^*)) \geq 2$.  To do this, we show that $\sum_{i \in C_1, j \in C} x_{ij} \geq 1$.  Since $x(\delta(i_1)) = 2$, it must be the case that either $\sum_{j \in C} x_{i_1j} \leq 1$ or $\sum_{j \in C_1} x_{i_1j} \leq 1$; without loss of generality we assume the former is true.  Then since $x(\delta(C_1 \cup \set{i_1})) \geq 2$, and $x(\delta(C_1 \cup \set{i_1})) = \sum_{j \in C} x_{i_1j} + \sum_{i \in C_1, j \in C} x_{ij}$, it follows that $\sum_{i \in C_1, j \in C} x_{ij} \geq 1$, and the proof is complete.
\mqed\end{proof}

