\def\finex{{\unskip\nobreak\hfil
\penalty50\hskip1em\null\nobreak\hfil$\diamond$
\parfillskip=0pt\finalhyphendemerits=0\endgraf}}

\lstdefinelanguage{JavaScript}{
  morekeywords=[1]{break, continue, delete, else, for, function, if, in,
    new, return, this, typeof, var, void, while, with, type, constructor, public},
morekeywords=[2]{false, null, true, boolean, number, undefined,
    Array, Boolean, Date, Math, Number, String, Object},
morekeywords=[3]{eval, parseInt, parseFloat, escape, unescape},
  sensitive,
  morecomment=[s]{/*}{*/},
  morecomment=[l]//,
  morecomment=[s]{/**}{*/}, morestring=[b]',
  morestring=[b]"
}[keywords, comments, strings]

\lstdefinelanguage[ECMAScript2015]{JavaScript}[]{JavaScript}{
  morekeywords=[1]{await, async, case, catch, class, const, default, do,
    enum, export, extends, finally, from, implements, import, instanceof,
    let, static, super, switch, throw, try},
  morestring=[b]` }
\lstalias[]{ES6}[ECMAScript2015]{JavaScript}

\definecolor{mediumgray}{rgb}{0.3, 0.4, 0.4}
\definecolor{mediumblue}{rgb}{0.0, 0.0, 0.8}
\definecolor{forestgreen}{rgb}{0.13, 0.55, 0.13}
\definecolor{darkviolet}{rgb}{0.58, 0.0, 0.83}
\definecolor{royalblue}{rgb}{0.25, 0.41, 0.88}
\definecolor{crimson}{rgb}{0.86, 0.8, 0.24}

\lstdefinestyle{JSES6Base}{
  basicstyle=\ttfamily\footnotesize\lstextra,
  breakatwhitespace=false,
  breaklines=false,
  columns=fullflexible,
  commentstyle=\color{mediumgray}\upshape,
  emph={},
  emphstyle=\color{crimson},
  extendedchars=true,  fontadjust=true,
  identifierstyle=\color{black},
  keepspaces=true,
  keywordstyle=\color{mediumblue},
  keywordstyle={[2]\color{darkviolet}},
  keywordstyle={[3]\color{royalblue}},
  numbers=left,
  numbersep=3pt,
  xleftmargin=8pt,
  numberstyle=\tiny\color{black},
  showlines=true,
  showspaces=false,
  showstringspaces=false,
  showtabs=false,
  stringstyle=\color{forestgreen},
  tabsize=2,
  upquote=true  }
\let\lstextra=\relax

\lstdefinestyle{JavaScript}{
  language=JavaScript,
  style=JSES6Base
}
\lstdefinestyle{ES6}{
  language=ES6,
  style=JSES6Base
}

\lstset{style=ES6}
\lstset{escapeinside={(*@}{@*)}}

\usepackage{tikz}
\usetikzlibrary{arrows,automata,calc}
\usetikzlibrary{shapes.symbols,shadows,decorations}
\tikzset{
  gt/.style={
         ->,
         >=stealth',
         shorten >=.1pt,
         auto,
         node distance=5cm,
         scale = 1,
         every state/.style={inner sep = 2pt, minimum size = 0pt, font=\footnotesize},
         transform shape
  },
lt/.style={
         ->,>=stealth',shorten >=1pt,auto,node distance=5cm,scale = 0.97,transform shape,
  },
  initial/.style={
         state,initial by arrow, initial text={}
  }
}
