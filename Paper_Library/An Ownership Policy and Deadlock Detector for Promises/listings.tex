% format for code listings
\lstset{
  float,
  belowskip=-\baselineskip,
  escapechar=\#,
  numbers=left,
  xleftmargin=15pt,
  numbersep=5pt,
  language=Java,
  basicstyle=\footnotesize\sffamily,
  commentstyle=\color{MidnightBlue},
  keywordstyle=[1]\bfseries,
  morekeywords=[1]{async},
  keywordstyle=[2]\itshape,
  morekeywords=[2]{},
  keywordstyle=[3]\bfseries\color{RedOrange},
  morekeywords=[3]{put,set,complete,completeExceptionally},
  keywordstyle=[4]\bfseries\color{LimeGreen},
  morekeywords=[4]{get,join},
  keywordstyle=[5]\bfseries\color{Magenta},
  morekeywords=[5]{guard}
}

% fix bug with float option for lstset
\makeatletter
\let\lst@floatdefault\lst@float
\makeatother

\def\lstDeadlock{
  \lstinputlisting[
  caption={A deadlock?},
  label={lst:deadlock}]
  {listings/deadlock.java}
}

\def\lstOmittedSet{
  \lstinputlisting[
  caption={An omitted set?},
  label={lst:omittedset}]
  {listings/omittedset.java}
}

\def\lstChannel{
  \lstinputlisting[
  caption={Object-oriented approach to promise movement.},
  label={lst:channel}]
  {listings/channel.java}
}

\def\lstAmazon{
  \lstinputlisting[
  caption={An omitted set in Amazon AWS SDK (v2)~\cite{AWSBugReport}.
    Code abbreviated and inlined for clarity.},
  label={lst:amazon}]
  {listings/amazon.java}
}

