\section*{Appendix A}
\label{sec:models}
This appendix includes the sequential models for the different tools (when a textual representation is available). 
The all these models, together with the other graphical models for CPN Tools and ProB, can be retrieved from the MARS repository.

\subsection{CADP-LNT}
{\scriptsize 
\begin{verbatim}

module CADP_ONEWAY8SEQ is

------------------------------------------------------------------------------

type Train_Number is
   range 0 .. 7 of nat
end type

------------------------------------------------------------------------------

type Train_Mission is
    array [0 .. 6] of nat
end type

------------------------------------------------------------------------------

type Train_Constraint is
    array [0 .. 6] of int -- actually, of range -1 .. 1
end type

------------------------------------------------------------------------------

channel Movement is
   (Train : Train_Number)
end channel

------------------------------------------------------------------------------

process MAIN [MOVE : Movement, ARRIVED : none] is
   var P0, P1, P2, P3, P4, P5, P6, P7 : nat,
       RA, RB : int,
       LA, LB : int,
       T0, T1, T2, T3, T4, T5, T6, T7 : Train_Mission,
       A0, A1, A2, A3, A4, A5, A6, A7 : Train_Constraint,
       B0, B1, B2, B3, B4, B5, B6, B7 : Train_Constraint
   in
      P0 := 0;
      P1 := 0;
      P2 := 0;
      P3 := 0;
      P4 := 0;
      P5 := 0;
      P6 := 0;
      P7 := 0;
      RA := 1;
      RB := 1;
      LA := 7; -- limit for region A
      LB := 7; -- limit for region B
      -- ------------  train missions ------------
      T0 := Train_Mission ( 1, 9,10,13,15,20,23);
      T1 := Train_Mission ( 3, 9,10,13,15,20,24);
      T2 := Train_Mission ( 5,27,11,13,16,20,25);
      T3 := Train_Mission ( 7,27,11,13,16,20,26);
      T4 := Train_Mission (23,22,17,18,11, 9, 2);
      T5 := Train_Mission (24,22,17,18,11, 9, 4);
      T6 := Train_Mission (25,22,17,18,12,27, 6);
      T7 := Train_Mission (26,22,17,18,12,27, 8);
      -- -----------------------------------------
      
      -- ----- region A: train constraints ------
      A0 := Train_Constraint ( 0, 0, 0, 1, 0,-1, 0);
      A1 := Train_Constraint ( 0, 0, 0, 1, 0,-1, 0);
      A2 := Train_Constraint ( 0, 0, 1,-1, 0, 1, 0);
      A3 := Train_Constraint ( 0, 0, 1,-1, 0, 0, 0);
      A4 := Train_Constraint ( 0, 1, 0, 0,-1, 0, 0);
      A5 := Train_Constraint ( 0, 1, 0, 0,-1, 0, 0);
      A6 := Train_Constraint ( 0, 0, 0,-1, 0, 0, 0);
      A7 := Train_Constraint ( 0, 1, 0,-1, 0, 0, 0);
      -- -----------------------------------------
      
      -- ----- region B: train constraints ------
      B0 := Train_Constraint ( 0, 0, 0, 1, 0,-1, 0);
      B1 := Train_Constraint ( 0, 0, 0, 1, 0,-1, 0);
      B2 := Train_Constraint ( 0, 0, 1,-1, 0, 0, 0);
      B3 := Train_Constraint ( 0, 0, 1,-1, 0, 1, 0);
      B4 := Train_Constraint ( 0, 1, 0, 0,-1, 0, 0);
      B5 := Train_Constraint ( 0, 1, 0, 0,-1, 0, 0);
      B6 := Train_Constraint ( 0, 1, 0,-1, 0, 0, 0);
      B7 := Train_Constraint ( 0, 0, 0,-1, 0, 0, 0);
      -- -----------------------------------------


      loop
         select
            only if
              (P0 < 6) and
              (T0 [P0+1] != T1 [P1]) and -- next place of train0 not occupied by train1
              (T0 [P0+1] != T2 [P2]) and -- next place of train0 not occupied by train2
              (T0 [P0+1] != T3 [P3]) and
              (T0 [P0+1] != T4 [P4]) and
              (T0 [P0+1] != T5 [P5]) and
              (T0 [P0+1] != T6 [P6]) and
              (T0 [P0+1] != T7 [P7]) and -- next place of train0 not occupied by train7
              (RA + A0 [P0+1] <= LA) and -- progress of train0 does not saturate RA
              (RB + B0 [P0+1] <= LB)     -- progress of train0 does not saturate RD
            then
               MOVE (0 of Train_Number);
               P0 := P0 + 1;
               RA := RA + A0 [P0];
               RB := RB + B0 [P0]
            end if
          []
            only if
              (P1 < 6) and
              (T1 [P1+1] != T0 [P0]) and 
              (T1 [P1+1] != T2 [P2]) and
              (T1 [P1+1] != T3 [P3]) and
              (T1 [P1+1] != T4 [P4]) and
              (T1 [P1+1] != T5 [P5]) and
              (T1 [P1+1] != T6 [P6]) and
              (T1 [P1+1] != T7 [P7]) and 
              (RA + A1 [P1+1] <= LA) and
              (RB + B1 [P1+1] <= LB)    
            then
               MOVE (1 of Train_Number);
               P1 := P1 + 1;
               RA := RA + A1 [P1];
               RB := RB + B1 [P1]
            end if
          []
            only if
              (P2 < 6) and
              (T2 [P2+1] != T0 [P0]) and
              (T2 [P2+1] != T1 [P1]) and
              (T2 [P2+1] != T3 [P3]) and
              (T2 [P2+1] != T4 [P4]) and
              (T2 [P2+1] != T5 [P5]) and
              (T2 [P2+1] != T6 [P6]) and
              (T2 [P2+1] != T7 [P7]) and  
              (RA + A2 [P2+1] <= LA) and
              (RB + B2 [P2+1] <= LB)     
            then
               MOVE (2 of Train_Number);
               P2 := P2 + 1;
               --if ( P2 == 13 ) then P2 := 0 end if; 
               RA := RA + A2 [P2];
               RB := RB + B2 [P2]
            end if
          []
            only if
              (P3 < 6) and
              (T3 [P3+1] != T0 [P0])  and
              (T3 [P3+1] != T1 [P1])  and
              (T3 [P3+1] != T2 [P2])  and
              (T3 [P3+1] != T4 [P4])  and
              (T3 [P3+1] != T5 [P5])  and
              (T3 [P3+1] != T6 [P6])  and
              (T3 [P3+1] != T7 [P7])  and
              (RA + A3 [P3+1] <= LA) and
              (RB + B3 [P3+1] <= LB)  
            then
               MOVE (3 of Train_Number);
               P3 := P3 + 1;
               RA := RA + A3 [P3];
               RB := RB + B3 [P3]
            end if
          []
            only if
              (P4 < 6) and
              (T4 [P4+1] != T0 [P0])  and
              (T4 [P4+1] != T1 [P1])  and
              (T4 [P4+1] != T2 [P2])  and
              (T4 [P4+1] != T3 [P3])  and
              (T4 [P4+1] != T5 [P5])  and
              (T4 [P4+1] != T6 [P6])  and
              (T4 [P4+1] != T7 [P7])  and
              (RA + A4 [P4+1] <= LA) and    
              (RB + B4 [P4+1] <= LB) 
            then
               MOVE (4 of Train_Number);
               P4 := P4 + 1;
               RA := RA + A4 [P4];
               RB := RB + B4 [P4]
            end if
          []
            only if
              (P5 < 6) and
              (T5 [P5+1] != T0 [P0]) and
              (T5 [P5+1] != T1 [P1]) and 
              (T5 [P5+1] != T2 [P2]) and
              (T5 [P5+1] != T3 [P3]) and
              (T5 [P5+1] != T4 [P4]) and
              (T5 [P5+1] != T6 [P6]) and
              (T5 [P5+1] != T7 [P7]) and
              (RA + A5 [P5+1] <= LA) and
              (RB + B5 [P5+1] <= LB)    
            then
               MOVE (5 of Train_Number);
               P5 := P5 + 1;
               RA := RA + A5 [P5];
               RB := RB + B5 [P5]
            end if
          []
            only if
              (P6 < 6) and
              (T6 [P6+1] != T0 [P0]) and
              (T6 [P6+1] != T1 [P1]) and
              (T6 [P6+1] != T2 [P2]) and
              (T6 [P6+1] != T3 [P3]) and
              (T6 [P6+1] != T4 [P4]) and
              (T6 [P6+1] != T5 [P5]) and
              (T6 [P6+1] != T7 [P7]) and
              (RA + A6 [P6+1] <= LA) and
              (RB + B6 [P6+1] <= LB)
            then
               MOVE (6 of Train_Number);
               P6 := P6 + 1;
               RA := RA + A6 [P6];
               RB := RB + B6 [P6]
            end if
          []
            only if
              (P7 < 6) and
              (T7 [P7+1] != T0 [P0])  and
              (T7 [P7+1] != T1 [P1])  and
              (T7 [P7+1] != T2 [P2])  and
              (T7 [P7+1] != T3 [P3])  and
              (T7 [P7+1] != T4 [P4])  and
              (T7 [P7+1] != T5 [P5])  and
              (T7 [P7+1] != T6 [P6])  and
              (RA + A7 [P7+1] <= LA) and
              (RB + B7 [P7+1] <= LB)
            then
               MOVE (7 of Train_Number);
               P7 := P7 + 1;
               RA := RA + A7 [P7];
               RB := RB + B7 [P7]
            end if
          []
            -- ALL TRAINS RUNNING
            only if (P0 == 6) and (P1 == 6) and (P2 == 6) and (P3 == 6) and 
                    (P4 == 6) and (P5 == 6) and (P6 == 6) and (P7 == 6) 
            then
               ARRIVED
            end if
         end select
      end loop
   end var
end process

end module

--
-- lnt.open cadp_oneway8.lnt generator x
-- bcg_info x.bcg
--     
--  1_636_545 states
--  7_134_233 transitions
--     
-- time lnt.open cadp_oneway8small.lnt evaluator4 cadpafarr.mcl
--      cadpafarr.mcl ==  mu XXX.(([not ARRIVED] XXX) and (<true> true))
--      cadpafarr.mcl ==  [ true* ] < true* . ARRIVED > true
--      cadpafarr.mcl ==  [ true* ] < true> true
--
-- >  TRUE
-- > 
-- > real	0m29.648s
-- > user	0m28.341s
-- > sys	0m1.078s
-- Evaluator4 Memory 78MB
--

\end{verbatim}
}

\subsection{FDR4}

{\scriptsize
\begin{verbatim}


M0 = < 1, 9,10,13,15,20,23>
M1 = < 3, 9,10,13,15,20,24>
M2 = < 5,27,11,13,16,20,25>
M3 = < 7,27,11,13,16,20,26>
M4 = <23,22,17,18,11, 9, 2>
M5 = <24,22,17,18,11, 9, 4>
M6 = <25,22,17,18,12,27, 6>
M7 = <26,22,17,18,12,27, 8>


  ------ region A: train constraints ------
A0 = < 0, 0, 0, 1, 0,-1, 0> -- G1
A1 = < 0, 0, 0, 1, 0,-1, 0> -- R1
A2 = < 0, 0, 1,-1, 0, 1, 0> -- Y1
A3 = < 0, 0, 1,-1, 0, 0, 0> -- B1
A4 = < 0, 1, 0, 0,-1, 0, 0> -- G2
A5 = < 0, 1, 0, 0,-1, 0, 0> -- R2
A6 = < 0, 0, 0,-1, 0, 0, 0> -- Y2
A7 = < 0, 1, 0,-1, 0, 0, 0> -- B2 
 ------------------------------------------

  ------- region B: train constraints ------
B0 = < 0, 0, 0, 1, 0,-1, 0> -- G1
B1 = < 0, 0, 0, 1, 0,-1, 0> -- R1
B2 = < 0, 0, 1,-1, 0, 0, 0> -- Y1
B3 = < 0, 0, 1,-1, 0, 1, 0> -- B1
B4 = < 0, 1, 0, 0,-1, 0, 0> -- G2
B5 = < 0, 1, 0, 0,-1, 0, 0> -- R2
B6 = < 0, 1, 0,-1, 0, 0, 0> -- Y2
B7 = < 0, 0, 0,-1, 0, 0, 0> -- B2
  ------------------------------------------
LA = 7
LB = 7

el(y,x) = if x==0 then head(y) else el(tail(y),x-1)

--channel move:{1..27}.{1..27}.{ -1..1}.{ -1..1}
channel move
channel  arrived

AllTrains (P0, P1, P2, P3, P4, P5, P6, P7, RA, RB) = 
     (P0 < 6 and    --  train0 has not yet reached all the steps of its mission
      el(T0,P0+1) != el(T1,P1)  and -- next place of train0 not occupied by train1
      el(T0,P0+1) != el(T2,P2)  and -- next place of train0 not occupied by train2
      el(T0,P0+1) != el(T3,P3)  and
      el(T0,P0+1) != el(T4,P4)  and
      el(T0,P0+1) != el(T5,P5)  and
      el(T0,P0+1) != el(T6,P6)  and
      el(T0,P0+1) != el(T7,P7)  and -- next place of train0 not occupied by train7
      RA + el(A0,P0+1) <= LA and  -- progress of train0 does not saturate RA 
      RB + el(B0,P0+1) <= LB     -- progress of train0 does not saturate RB
     )  &
       move -> AllTrains(P0+1,P1,P2,P3,P4,P5,P6,P7,RA+el(A0,P0+1),RB+el(B0,P0+1))
     []
     (P1 < 6 and
      el(T1,P1+1) != el(T0,P0)  and
      el(T1,P1+1) != el(T2,P2)  and
      el(T1,P1+1) != el(T3,P3)  and
      el(T1,P1+1) != el(T4,P4)  and
      el(T1,P1+1) != el(T5,P5)  and
      el(T1,P1+1) != el(T6,P6)  and
      el(T1,P1+1) != el(T7,P7)  and
      RA + el(A1,P1+1) <= LA and    
      RB + el(B1,P1+1) <= LB
     )  &
       move -> AllTrains(P0,P1+1,P2,P3,P4,P5,P6,P7,RA+el(A1,P1+1),RB+el(B1,P1+1))
     []
     (P2 < 6 and
      el(T2,P2+1) != el(T0,P0)  and
      el(T2,P2+1) != el(T1,P1)  and
      el(T2,P2+1) != el(T3,P3)  and
      el(T2,P2+1) != el(T4,P4)  and
      el(T2,P2+1) != el(T5,P5)  and
      el(T2,P2+1) != el(T6,P6)  and
      el(T2,P2+1) != el(T7,P7)  and
      RA + el(A2,P2+1) <= LA and    
      RB + el(B2,P2+1) <= LB
     )  &
       move -> AllTrains(P0,P1,P2+1,P3,P4,P5,P6,P7,RA+el(A2,P2+1),RB+el(B2,P2+1))
     []
     (P3 < 6 and
      el(T3,P3+1) != el(T0,P0)  and
      el(T3,P3+1) != el(T1,P1)  and
      el(T3,P3+1) != el(T2,P2)  and
      el(T3,P3+1) != el(T4,P4)  and
      el(T3,P3+1) != el(T5,P5)  and
      el(T3,P3+1) != el(T6,P6)  and
      el(T3,P3+1) != el(T7,P7)  and
      RA + el(A3,P3+1) <= LA and    
      RB + el(B3,P3+1) <= LB
     )  &
       move -> AllTrains(P0,P1,P2,P3+1,P4,P5,P6,P7,RA+el(A3,P3+1),RB+el(B3,P3+1))
     []
     (P4 < 6 and
      el(T4,P4+1) != el(T0,P0)  and
      el(T4,P4+1) != el(T1,P1)  and
      el(T4,P4+1) != el(T2,P2)  and
      el(T4,P4+1) != el(T3,P3)  and
      el(T4,P4+1) != el(T5,P5)  and
      el(T4,P4+1) != el(T6,P6)  and
      el(T4,P4+1) != el(T7,P7)  and
      RA + el(A4,P4+1) <= LA and    
      RB + el(B4,P4+1) <= LB
     )  &
       move -> AllTrains(P0,P1,P2,P3,P4+1,P5,P6,P7,RA+el(A4,P4+1),RB+el(B4,P4+1))
     []
     (P5 < 6 and
      el(T5,P5+1) != el(T0,P0)  and
      el(T5,P5+1) != el(T1,P1)  and
      el(T5,P5+1) != el(T2,P2)  and
      el(T5,P5+1) != el(T3,P3)  and
      el(T5,P5+1) != el(T4,P4)  and
      el(T5,P5+1) != el(T6,P6)  and
      el(T5,P5+1) != el(T7,P7)  and
      RA + el(A5,P5+1) <= LA and    
      RB + el(B5,P5+1) <= LB
     )  &
       move -> AllTrains(P0,P1,P2,P3,P4,P5+1,P6,P7,RA+el(A5,P5+1),RB+el(B5,P5+1))
     []
     (P6 < 6 and
      el(T6,P6+1) != el(T0,P0)  and
      el(T6,P6+1) != el(T1,P1)  and
      el(T6,P6+1) != el(T2,P2)  and
      el(T6,P6+1) != el(T3,P3)  and
      el(T6,P6+1) != el(T4,P4)  and
      el(T6,P6+1) != el(T5,P5)  and
      el(T6,P6+1) != el(T7,P7)  and
      RA + el(A6,P6+1) <= LA and    
      RB + el(B6,P6+1) <= LB
     )  &
       move -> AllTrains(P0,P1,P2,P3,P4,P5,P6+1,P7,RA+el(A6,P6+1),RB+el(B6,P6+1))
     []
     (P7 < 6 and
      el(T7,P7+1) != el(T0,P0)  and
      el(T7,P7+1) != el(T1,P1)  and
      el(T7,P7+1) != el(T2,P2)  and
      el(T7,P7+1) != el(T3,P3)  and
      el(T7,P7+1) != el(T4,P4)  and
      el(T7,P7+1) != el(T5,P5)  and
      el(T7,P7+1) != el(T6,P6)  and
      RA + el(A7,P7+1) <= LA and    
      RB + el(B7,P7+1) <= LB
     )  &
       move -> AllTrains(P0,P1,P2,P3,P4,P5,P6,P7+1,RA+el(A7,P7+1),RB+el(B7,P7+1))
     []
     ((P0 == 6) and (P1 ==6) and (P2 ==6) and (P3 ==6)  and 
      (P4 ==6) and (P5 ==6) and (P6 ==6) and (P7 ==6)
     ) &
       arrived -> STOP

--------------------------
ASYS = AllTrains(0,0,0,0,0,0,0,0, 1,1)\{move}
--------------------------
--  compression is helpful for two verifications/visualization
-- NSYS = normal(ASYS)
-- assert SPEC [FD= NSYS
--------------------------


--------------------------
SPEC = arrived -> STOP
--------------------------

assert SPEC [FD= ASYS

-- -------- verfication process : ---------------
--  time refines --refinement-storage-file-path swapdir fdr4_oneway8seq.txt
--



\end{verbatim}
}

\section{mCRL2}

{\scriptsize
\begin{verbatim}

%--------------------------------------------------------------
% T0 := [ 1, 9,10,13,15,20,23,22]; -- G1
% T1 := [ 3, 9,10,13,15,20,24,22]; -- R1
% T2 := [ 5,27,11,13,16,20,25,22]; -- Y1
% T3 := [ 7,27,11,13,16,20,26,22]; -- B1
% T4 := [23,22,17,18,11, 9, 2, 1]; -- G2
% T5 := [24,22,17,18,11, 9, 4, 3]; -- R2
% T6 := [25,22,17,18,12,27, 6, 5]; -- Y2
% T7 := [26,22,17,18,12,27, 8, 7]; -- B2
%--------------------------------------------------------------

map T0: Nat -> Nat;
 eqn T0(0)= 1; T0(1)= 9; T0(2)=10; T0( 3)=13; T0( 4)=15; T0( 5)=20; T0( 6)=23;
     
map T1: Nat -> Nat;
 eqn T1(0)= 3; T1(1)=9;  T1(2)=10; T1( 3)=13; T1( 4)=15; T1( 5)=20; T1( 6)=24;
  
map T2: Nat -> Nat;
 eqn T2(0)= 5; T2(1)=27; T2(2)=11; T2( 3)=13; T2( 4)=16; T2( 5)=20; T2( 6)=25;
  
map T3: Nat -> Nat;
 eqn T3(0)= 7; T3(1)=27; T3(2)=11; T3( 3)=13; T3( 4)=16; T3( 5)=20; T3( 6)=26;
  
map T4: Nat -> Nat;
 eqn T4(0)=23; T4(1)=22; T4(2)=17; T4( 3)=18; T4( 4)=11; T4( 5)= 9; T4( 6)= 2;
  
map T5: Nat -> Nat;
 eqn T5(0)=24; T5(1)=22; T5(2)=17; T5( 3)=18; T5( 4)=11; T5( 5)=9;  T5( 6)= 4;
  
map T6: Nat -> Nat;
 eqn T6(0)=25; T6(1)=22; T6(2)=17; T6(3)=18; T6(4)=12; T6(5)=27; T6(6)=6;
     T6(7)= 5; T6(8)=27; T6(9)=11; T6(10)=13; T6(11)=16; T6(12)=20; T6(13)=25;
     
map T7: Nat -> Nat;
 eqn T7(0)=26; T7(1)=22; T7(2)=17; T7( 3)=18; T7( 4)=12; T7( 5)=27; T7( 6)= 8;
  
% ------ region A: train constraints ------
%         0  1  2  3  4  5  6
% A0 := [ 0, 0, 0, 1, 0,-1, 0]; -- G1
% A1 := [ 0, 0, 0, 1, 0,-1, 0]; -- R1
% A2 := [ 0, 0, 1,-1, 0, 1, 0]; -- Y1
% A3 := [ 0, 0, 1,-1, 0, 0, 0]; -- B1
% A4 := [ 0, 1, 0, 0,-1, 0, 0]; -- G2
% A5 := [ 0, 1, 0, 0,-1, 0, 0]; -- R2
% A6 := [ 0, 0, 0,-1, 0, 0, 0]; -- Y2
% A7 := [ 0, 1, 0,-1, 0, 0, 0]; -- B2
% ------------------------------------------
map  LA: Nat;  %  limit for region A
 eqn  LA = 7;
 
map A0: Nat -> Int;
 eqn A0(0)=0; A0(1)=0; A0(2)=0; A0( 3)= 1; A0( 4)=0; A0( 5)=-1; A0( 6)=0;
 
map A1: Nat -> Int;
 eqn A1(0)=0; A1(1)=0; A1(2)=0; A1( 3)= 1; A1( 4)=0; A1( 5)=-1; A1( 6)=0;
 
map A2: Nat -> Int;
 eqn A2(0)=0; A2(1)=0; A2(2)= 1; A2( 3)=-1; A2( 4)=0; A2( 5)= 1; A2( 6)=0;
 
map A3: Nat -> Int;
 eqn A3(0)=0; A3(1)=0; A3(2)= 1; A3( 3)=-1; A3( 4)=0; A3( 5)= 0; A3( 6)=0;
 
map A4: Nat -> Int;
 eqn A4(0)=0; A4(1)=1; A4(2)=0; A4( 3)=0; A4( 4)=-1; A4( 5)= 0; A4( 6)=0;
 
map A5: Nat -> Int;
 eqn A5(0)=0; A5(1)=1; A5(2)=0; A5( 3)=0; A5( 4)=-1; A5( 5)= 0; A5( 6)=0;
 
map A6: Nat -> Int;
 eqn A6(0)=0; A6(1)=0; A6(2)=0; A6( 3)=-1; A6( 4)=0; A6( 5)= 0; A6( 6)=0;
 
map A7: Nat -> Int;
 eqn A7(0)=0; A7(1)=1; A7(2)=0; A7( 3)=-1; A7( 4)=0; A7( 5)= 0; A7( 6)=0;

% ------- region B: train constraints ------
%         0  1  2  3  4  5  6
% B0 := [ 0, 0, 0, 1, 0,-1, 0]; -- G1
% B1 := [ 0, 0, 0, 1, 0,-1, 0]; -- R1
% B2 := [ 0, 0, 1,-1, 0, 0, 0]; -- Y1
% B3 := [ 0, 0, 1,-1, 0, 1, 0]; -- B1
% B4 := [ 0, 1, 0, 0,-1, 0, 0]; -- G2
% B5 := [ 0, 1, 0, 0,-1, 0, 0]; -- R2
% B6 := [ 0, 1, 0,-1, 0, 0, 0]; -- Y2
% B7 := [ 0, 0, 0,-1, 0, 0, 0]; -- B2
% ------------------------------------------
map  LB: Nat;  %  limit for region B
 eqn  LB = 7;
 
map B0: Nat -> Int;
 eqn B0(0)=0; B0(1)=0; B0(2)=0; B0( 3)= 1; B0( 4)=0; B0( 5)=-1; B0( 6)=0;
 
map B1: Nat -> Int;
 eqn B1(0)=0; B1(1)=0; B1(2)=0; B1( 3)= 1; B1( 4)=0; B1( 5)=-1; B1( 6)=0;
 
map B2: Nat -> Int;
 eqn B2(0)=0; B2(1)=0; B2(2)= 1; B2( 3)=-1; B2( 4)=0; B2( 5)= 0; B2( 6)=0;
 
map B3: Nat -> Int;
 eqn B3(0)=0; B3(1)=0; B3(2)= 1; B3( 3)=-1; B3( 4)=0; B3( 5)= 1; B3( 6)=0;
 
map B4: Nat -> Int;
 eqn B4(0)=0; B4(1)=1; B4(2)=0; B4( 3)=-0; B4( 4)=-1; B4( 5)= 0; B4( 6)=0;
 
map B5: Nat -> Int;
 eqn B5(0)=0; B5(1)=1; B5(2)=0; B5( 3)=0; B5( 4)=-1; B5( 5)= 0; B5( 6)=0;
 
map B6: Nat -> Int;
 eqn B6(0)=0; B6(1)=1; B6(2)=0; B6( 3)=-1; B6( 4)=0; B6( 5)= 0; B6( 6)=0;
 
map B7: Nat -> Int;
 eqn B7(0)=0; B7(1)=0; B7(2)=0; B7( 3)=-1; B7( 4)=0; B7( 5)= 0; B7( 6)=0;

act  arrived;
     move: Nat;

proc AllTrains(
   P0:Nat,P1:Nat,P2:Nat,P3:Nat,P4:Nat,P5:Nat,P6:Nat,P7:Nat,RA: Int,RB: Int) = 
     (P0 < 6 &&    %  train0 has not yet reached all the steps of its mission
      T0(P0+1) != T1(P1)  && % next place of train0 not occupied by train1
      T0(P0+1) != T2(P2)  && % next place of train0 not occupied by train2
      T0(P0+1) != T3(P3)  &&
      T0(P0+1) != T4(P4)  &&
      T0(P0+1) != T5(P5)  &&
      T0(P0+1) != T6(P6)  &&
      T0(P0+1) != T7(P7)  && % next place of train0 not occupied by train7
      RA + A0(P0+1) <= LA &&  % progress of train0 does not saturate RA 
      RB + B0(P0+1) <= LB     % progress of train0 does not saturate RB
     )  ->
       move(0). AllTrains(P0+1,P1,P2,P3,P4,P5,P6,P7,RA+A0(P0+1),RB+B0(P0+1))
     +
     (P1 < 6 &&
      T1(P1+1) != T0(P0)  &&
      T1(P1+1) != T2(P2)  &&
      T1(P1+1) != T3(P3)  &&
      T1(P1+1) != T4(P4)  &&
      T1(P1+1) != T5(P5)  &&
      T1(P1+1) != T6(P6)  &&
      T1(P1+1) != T7(P7)  &&
      RA + A1(P1+1) <= LA &&    
      RB + B1(P1+1) <= LB
     )  ->
       move(1). AllTrains(P0,P1+1,P2,P3,P4,P5,P6,P7,RA+A1(P1+1),RB+B1(P1+1))
     +
     (P2 < 6 &&
      T2(P2+1) != T0(P0)  &&
      T2(P2+1) != T1(P1)  &&
      T2(P2+1) != T3(P3)  &&
      T2(P2+1) != T4(P4)  &&
      T2(P2+1) != T5(P5)  &&
      T2(P2+1) != T6(P6)  &&
      T2(P2+1) != T7(P7)  &&
      RA + A2(P2+1) <= LA &&    
      RB + B2(P2+1) <= LB
     )  ->
       move(2). AllTrains(P0,P1,P2+1,P3,P4,P5,P6,P7,RA+A2(P2+1),RB+B2(P2+1))
     +
     (P3 < 6 &&
      T3(P3+1) != T0(P0)  &&
      T3(P3+1) != T1(P1)  &&
      T3(P3+1) != T2(P2)  &&
      T3(P3+1) != T4(P4)  &&
      T3(P3+1) != T5(P5)  &&
      T3(P3+1) != T6(P6)  &&
      T3(P3+1) != T7(P7)  &&
      RA + A3(P3+1) <= LA &&    
      RB + B3(P3+1) <= LB
     )  ->
       move(3). AllTrains(P0,P1,P2,P3+1,P4,P5,P6,P7,RA+A3(P3+1),RB+B3(P3+1))
     +
     (P4 < 6 &&
      T4(P4+1) != T0(P0)  &&
      T4(P4+1) != T1(P1)  &&
      T4(P4+1) != T2(P2)  &&
      T4(P4+1) != T3(P3)  &&
      T4(P4+1) != T5(P5)  &&
      T4(P4+1) != T6(P6)  &&
      T4(P4+1) != T7(P7)  &&
      RA + A4(P4+1) <= LA &&    
      RB + B4(P4+1) <= LB
     )  ->
       move(4). AllTrains(P0,P1,P2,P3,P4+1,P5,P6,P7,RA+A4(P4+1),RB+B4(P4+1))
     +
     (P5 < 6 &&
      T5(P5+1) != T0(P0)  &&
      T5(P5+1) != T1(P1)  &&
      T5(P5+1) != T2(P2)  &&
      T5(P5+1) != T3(P3)  &&
      T5(P5+1) != T4(P4)  &&
      T5(P5+1) != T6(P6)  &&
      T5(P5+1) != T7(P7)  &&
      RA + A5(P5+1) <= LA &&    
      RB + B5(P5+1) <= LB
     )  ->
       move(5). AllTrains(P0,P1,P2,P3,P4,P5+1,P6,P7,RA+A5(P5+1),RB+B5(P5+1))
     +
     (P6 < 6 &&
      T6(P6+1) != T0(P0)  &&
      T6(P6+1) != T1(P1)  &&
      T6(P6+1) != T2(P2)  &&
      T6(P6+1) != T3(P3)  &&
      T6(P6+1) != T4(P4)  &&
      T6(P6+1) != T5(P5)  &&
      T6(P6+1) != T7(P7)  &&
      RA + A6(P6+1) <= LA &&    
      RB + B6(P6+1) <= LB
     )  ->
       move(6). AllTrains(P0,P1,P2,P3,P4,P5,P6+1,P7,RA+A6(P6+1),RB+B6(P6+1))
     +
     (P7 < 6 &&
      T7(P7+1) != T0(P0)  &&
      T7(P7+1) != T1(P1)  &&
      T7(P7+1) != T2(P2)  &&
      T7(P7+1) != T3(P3)  &&
      T7(P7+1) != T4(P4)  &&
      T7(P7+1) != T5(P5)  &&
      T7(P7+1) != T6(P6)  &&
      RA + A7(P7+1) <= LA &&    
      RB + B7(P7+1) <= LB
     )  ->
       move(7). AllTrains(P0,P1,P2,P3,P4,P5,P6,P7+1,RA+A7(P7+1),RB+B7(P7+1))

     +
     ((P0 ==6) && (P1 ==6) && (P2 ==6) && (P3 ==6)  && 
      (P4 ==6) && (P5 ==6) && (P6 ==6) && (P7 ==6)) ->
       arrived . AllTrains(P0,P1,P2,P3,P4,P5,P6,P7,RA,RB);

init   AllTrains(0,0,0,0,0,0,0,0, 1,1);
     

%%%%%%%%%%% verfication process : %%%%%%%%%%%%%%%%%
% 
% mcrl22lps mcrl2_oneway8seq.txt temp.lps
% lps2pbes -fformula.mcf  temp.lps  temp.pbes
%     formula.mcf=  "mu X.(([!arrived]X) && (<true> true))"  ==  AF {arrived}
% time pbes2bool -s2 -vrjittyc temp.pbes
% > real	1m53.996s
% > user	1m52.243s
% > sys	    0m1.583s
% > USED VIRTUAL MEMORY  1.06 GB
%
% time pbes2bool -s2 temp.pbes
% > real  19m47.753s
%
% lps2lts -rjittyc --verbose temp.lps temp.lts 
% ltsinfo temp.lts
% >  state space stats: (49 levels, 1_636_545 states and 7_134_233 transitions)
% >
% >
%
% formula.mcf=  "mu X.(([!arrived]X) && (<true> true))"  ==  AF {arrived}
% formula.mcf=  "[ true* ] < true* . ARRIVED > true"     ==  AG EF {arrived}
%  pbes2bool  -c print evidence on validity of formula, nedded by lpsxsim for 
% 
% lps2lts --verbose –rjittyc –cached -D -F  temp.lps temp.lts
%    ( -sdepth  -sBreadth --suppress --todo=maxnum --no-info
%
% the generation of counter-examples
%  pbes2bool -zb    breadth-first
%  pbes2bool -zd    depth-first
%  pbes2bool --todo  -strategy  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\end{verbatim}
}

\section{ProB}

{\scriptsize
\begin{verbatim}
/* https://www3.hhu.de/stups/prob/index.php/Summary_of_B_Syntax */

MACHINE Oneway
 
DEFINITIONS
  SET_PREF_MAXINT == 1;
  SET_PREF_MININT == 0
  
CONSTANTS  
   T0,T1,T2,T3,T4,T5,T6,T7,
   A0,A1,A2,A3,A4,A5,A6,A7,
   B0,B1,B2,B3,B4,B5,B6,B7,
   LA,LB

PROPERTIES 
/*
------- train missions --------------
T0: int[] := [ 1, 9,10,13,15,20,23]; -- G1
T1: int[] := [ 3, 9,10,13,15,20,24]; -- R1
T2: int[] := [ 5,27,11,13,16,20,25]; -- Y1
T3: int[] := [ 7,27,11,13,16,20,26]; -- B1
T4: int[] := [23,22,17,18,11, 9, 2]; -- G2
T5: int[] := [24,22,17,18,11, 9, 4]; -- R2
T6: int[] := [25,22,17,18,12,27, 6]; -- Y2
T7: int[] := [26,22,17,18,12,27, 8]; -- B2

------ region A: train constraints ------
A0: int[] := [ 0, 0, 0, 1, 0,-1, 0]; -- G1
A1: int[] := [ 0, 0, 0, 1, 0,-1, 0]; -- R1
A2: int[] := [ 0, 0, 1,-1, 0, 1, 0]; -- Y1
A3: int[] := [ 0, 0, 1,-1, 0, 0, 0]; -- B1
A4: int[] := [ 0, 1, 0, 0,-1, 0, 0]; -- G2
A5: int[] := [ 0, 1, 0, 0,-1, 0, 0]; -- R2
A6: int[] := [ 0, 0, 0,-1, 0, 0, 0]; -- Y2
A7: int[] := [ 0, 1, 0,-1, 0, 0, 0]; -- B2

------- region B: train constraints ------
B0: int[] := [ 0, 0, 0, 1, 0,-1, 0]; -- G1
B1: int[] := [ 0, 0, 0, 1, 0,-1, 0]; -- R1
B2: int[] := [ 0, 0, 1,-1, 0, 0, 0]; -- Y1
B3: int[] := [ 0, 0, 1,-1, 0, 1, 0]; -- B1
B4: int[] := [ 0, 1, 0, 0,-1, 0, 0]; -- G2
B5: int[] := [ 0, 1, 0, 0,-1, 0, 0]; -- R2
B6: int[] := [ 0, 1, 0,-1, 0, 0, 0]; -- Y2
B7: int[] := [ 0, 0, 0,-1, 0, 0, 0]; -- B2
------------------------------------------
*/

  T0 : 0..6 --> 1..27 & 
  T1 : 0..6 --> 1..27 & 
  T2 : 0..6 --> 1..27 & 
  T3 : 0..6 --> 1..27 & 
  T4 : 0..6 --> 1..27 & 
  T5 : 0..6 --> 1..27 & 
  T6 : 0..6 --> 1..27 &
  T7 : 0..6 --> 1..27 &
  
  A0 : 0..6 --> -1..1 &
  A1 : 0..6 --> -1..1 & 
  A2 : 0..6 --> -1..1 & 
  A3 : 0..6 --> -1..1 & 
  A4 : 0..6 --> -1..1 & 
  A5 : 0..6 --> -1..1 & 
  A6 : 0..6 --> -1..1 &
  A7 : 0..6 --> -1..1 &
  
  B0 : 0..6 --> -1..1 &
  B1 : 0..6 --> -1..1 & 
  B2 : 0..6 --> -1..1 & 
  B3 : 0..6 --> -1..1 & 
  B4 : 0..6 --> -1..1 & 
  B5 : 0..6 --> -1..1 & 
  B6 : 0..6 --> -1..1 &
  B7 : 0..6 --> -1..1 &
  
  T0(0)= 1 & T0(1)= 9 & T0(2)=10 & T0(3)=13 & T0(4)=15 & T0(5)=20 & T0(6)=23 &
  T1(0)= 3 & T1(1)= 9 & T1(2)=10 & T1(3)=13 & T1(4)=15 & T1(5)=20 & T1(6)=24 &
  T2(0)= 5 & T2(1)=27 & T2(2)=11 & T2(3)=13 & T2(4)=16 & T2(5)=20 & T2(6)=25 &
  T3(0)= 7 & T3(1)=27 & T3(2)=11 & T3(3)=13 & T3(4)=16 & T3(5)=20 & T3(6)=26 &
  T4(0)=23 & T4(1)=22 & T4(2)=17 & T4(3)=18 & T4(4)=11 & T4(5)= 9 & T4(6)=2 &
  T5(0)=24 & T5(1)=22 & T5(2)=17 & T5(3)=18 & T5(4)=11 & T5(5)= 9 & T5(6)=4 &
  T6(0)=25 & T6(1)=22 & T6(2)=17 & T6(3)=18 & T6(4)=12 & T6(5)=27 & T6(6)=6 &
  T7(0)=26 & T7(1)=22 & T7(2)=17 & T7(3)=18 & T7(4)=12 & T7(5)=27 & T7(6)=8 &
  
  A0(0)=0 & A0(1)=0 & A0(2)=0 & A0(3)= 1 & A0(4)= 0 & A0(5)=-1 & A0( 6)=0 &
  A1(0)=0 & A1(1)=0 & A1(2)=0 & A1(3)= 1 & A1(4)= 0 & A1(5)=-1 & A1( 6)=0 &
  A2(0)=0 & A2(1)=0 & A2(2)=1 & A2(3)=-1 & A2(4)= 0 & A2(5)= 1 & A2( 6)=0 &
  A3(0)=0 & A3(1)=0 & A3(2)=1 & A3(3)=-1 & A3(4)= 0 & A3(5)= 0 & A3( 6)=0 &
  A4(0)=0 & A4(1)=1 & A4(2)=0 & A4(3)= 0 & A4(4)=-1 & A4(5)= 0 & A4( 6)=0 &
  A5(0)=0 & A5(1)=1 & A5(2)=0 & A5(3)= 0 & A5(4)=-1 & A5(5)= 0 & A5( 6)=0 &
  A6(0)=0 & A6(1)=0 & A6(2)=0 & A6(3)=-1 & A6(4)= 0 & A6(5)= 0 & A6( 6)=0 &
  A7(0)=0 & A7(1)=1 & A7(2)=0 & A7(3)=-1 & A7(4)= 0 & A7(5)= 0 & A7( 6)=0 &
  
  B0(0)=0 & B0(1)=0 & B0(2)=0 & B0(3)= 1 & B0(4)= 0 & B0(5)=-1 & B0( 6)=0 &
  B1(0)=0 & B1(1)=0 & B1(2)=0 & B1(3)= 1 & B1(4)= 0 & B1(5)=-1 & B1( 6)=0 &
  B2(0)=0 & B2(1)=0 & B2(2)=1 & B2(3)=-1 & B2(4)= 0 & B2(5)= 0 & B2( 6)=0 &
  B3(0)=0 & B3(1)=0 & B3(2)=1 & B3(3)=-1 & B3(4)= 0 & B3(5)= 1 & B3( 6)=0 &
  B4(0)=0 & B4(1)=1 & B4(2)=0 & B4(3)=-0 & B4(4)=-1 & B4(5)= 0 & B4( 6)=0 &
  B5(0)=0 & B5(1)=1 & B5(2)=0 & B5(3)= 0 & B5(4)=-1 & B5(5)= 0 & B5( 6)=0 &
  B6(0)=0 & B6(1)=1 & B6(2)=0 & B6(3)=-1 & B6(4)= 0 & B6(5)= 0 & B6( 6)=0 &
  B7(0)=0 & B7(1)=0 & B7(2)=0 & B7(3)=-1 & B7(4)= 0 & B7(5)= 0 & B7( 6)=0 &
  
  LA=7 & LB=7
  
VARIABLES 
  P0,P1,P2,P3,P4,P5,P6,P7,RA,RB

INVARIANT 
  P0:0..6 & P1:0..6 & P2:0..6 & P3:0..6 & P4:0..6 & P5:0..6 & P6:0..6 & P7:0..6 &
  RA:0..8 & RB:0..8

INITIALISATION 
  P0:=0; P1:=0; P2:=0; P3:=0; P4:=0; P5:=0; P6:=0; P7:=0; RA:=1; RB:=1

OPERATIONS
  move0 = 
    PRE P0<6 & 
      T0(P0+1) /= T1(P1) & 
      T0(P0+1) /= T2(P2 )& 
      T0(P0+1) /= T3(P3 )& 
      T0(P0+1) /= T4(P4) & 
      T0(P0+1) /= T5(P5) & 
      T0(P0+1) /= T6(P6) & 
      T0(P0+1) /= T7(P7) &
      RA + A0(P0+1) <= LA &
      RB + B0(P0+1) <= LB
    THEN 
      P0 := P0+1;
      RA := RA + A0(P0);
      RB := RB + B0(P0)
    END ;

  move1 = 
    PRE P1<6 & 
      T1(P1+1) /= T0(P0) & 
      T1(P1+1) /= T2(P2) &
      T1(P1+1) /= T3(P3) & 
      T1(P1+1) /= T4(P4) & 
      T1(P1+1) /= T5(P5) & 
      T1(P1+1) /= T6(P6) & 
      T1(P1+1) /= T7(P7) &
      RA + A1(P1+1) <= LA &
      RB + B1(P1+1) <= LB
    THEN 
      P1 := P1+1;
      RA := RA + A1(P1);
      RB := RB + B1(P1)
    END ;
               
  move2 = 
    PRE P2<6 & 
      T2(P2+1) /= T0(P0) & 
      T2(P2+1) /= T1(P1) &
      T2(P2+1) /= T3(P3) & 
      T2(P2+1) /= T4(P4) & 
      T2(P2+1) /= T5(P5) & 
      T2(P2+1) /= T6(P6) & 
      T2(P2+1) /= T7(P7) &
      RA + A2(P2+1) <= LA &
      RB + B2(P2+1) <= LB
    THEN 
      P2 := P2+1;
      RA := RA + A2(P2);
      RB := RB + B2(P2)
    END ;
               
  move3 = 
    PRE P3<6 & 
      T3(P3+1) /= T0(P0) & 
      T3(P3+1) /= T1(P1) &
      T3(P3+1) /= T2(P2) & 
      T3(P3+1) /= T4(P4) & 
      T3(P3+1) /= T5(P5) & 
      T3(P3+1) /= T6(P6) & 
      T3(P3+1) /= T7(P7) &
      RA + A3(P3+1) <= LA &
      RB + B3(P3+1) <= LB
    THEN 
      P3 := P3+1;
      RA := RA + A3(P3);
      RB := RB + B3(P3)
    END ;
    
  move4 = 
    PRE P4<6 & 
      T4(P4+1) /= T0(P0) & 
      T4(P4+1) /= T1(P1) & 
      T4(P4+1) /= T2(P2) & 
      T4(P4+1) /= T3(P3) & 
      T4(P4+1) /= T5(P5) & 
      T4(P4+1) /= T6(P6) & 
      T4(P4+1) /= T7(P7) &
      RA + A4(P4+1) <= LA &
      RB + B4(P4+1) <= LB
    THEN 
      P4 := P4+1;
      RA := RA + A4(P4);
      RB := RB + B4(P4)
    END ;

  move5 = 
    PRE P5<6 & 
      T5(P5+1) /= T0(P0) & 
      T5(P5+1) /= T1(P1) &  
      T5(P5+1) /= T2(P2) &
      T5(P5+1) /= T3(P3) & 
      T5(P5+1) /= T4(P4) & 
      T5(P5+1) /= T6(P6) & 
      T5(P5+1) /= T7(P7) &
      RA + A5(P5+1) <= LA &
      RB + B5(P5+1) <= LB
    THEN 
      P5 := P5+1;
      RA := RA + A5(P5);
      RB := RB + B5(P5)
    END ;
    
  move6 = 
    PRE P6<6 & 
      T6(P6+1) /= T0(P0) & 
      T6(P6+1) /= T1(P1) & 
      T6(P6+1) /= T2(P2) & 
      T6(P6+1) /= T3(P3) & 
      T6(P6+1) /= T4(P4) & 
      T6(P6+1) /= T5(P5) & 
      T6(P6+1) /= T7(P7) &
      RA + A6(P6+1) <= LA &
      RB + B6(P6+1) <= LB
    THEN 
      P6 := P6+1;
      RA := RA + A6(P6);
      RB := RB + B6(P6)
    END ;
    
  move7 = 
    PRE P7<6 & 
      T7(P7+1) /= T0(P0) & 
      T7(P7+1) /= T1(P1) & 
      T7(P7+1) /= T2(P2) & 
      T7(P7+1) /= T3(P3) & 
      T7(P7+1) /= T4(P4) & 
      T7(P7+1) /= T5(P5) & 
      T7(P7+1) /= T6(P6) &
      RA + A7(P7+1) <= LA &
      RB + B7(P7+1) <= LB
    THEN 
      P7 := P7+1;
      RA := RA + A7(P7);
      RB := RB + B7(P7)
    END ;
	
  arrived = 
    PRE 
       P0=6 & P1=6 & P2=6 & P3=6 & P4=6 & P5=6 & P6=6 & P7=6 
    THEN 
       skip 
    END
END
 
//--------------------
//  SEARCHING DEADLOCKS:  1_636_547 states,   7_134_235 trans.  TIME  32 min   VMEM  3 GB
//-------------------

\end{verbatim}
}

\section{NuSMV/nuXmv}

{\scriptsize
\begin{verbatim}
MODULE main
 
  -------  train missions ------------------
DEFINE 
T0 := [ 1, 9,10,13,15,20,23]; -- G1
T1 := [ 3, 9,10,13,15,20,24]; -- R1
T2 := [ 5,27,11,13,16,20,25]; -- Y1
T3 := [ 7,27,11,13,16,20,26]; -- B1
T4 := [23,22,17,18,11, 9, 2]; -- G2
T5 := [24,22,17,18,11, 9, 4]; -- R2
T6 := [25,22,17,18,12,27, 6]; -- Y2
T7 := [26,22,17,18,12,27, 8]; -- B2

  ------ region A: train constraints ------
A0 := [ 0, 0, 0, 1, 0,-1, 0]; -- G1
A1 := [ 0, 0, 0, 1, 0,-1, 0]; -- R1
A2 := [ 0, 0, 1,-1, 0, 1, 0]; -- Y1
A3 := [ 0, 0, 1,-1, 0, 0, 0]; -- B1
A4 := [ 0, 1, 0, 0,-1, 0, 0]; -- G2
A5 := [ 0, 1, 0, 0,-1, 0, 0]; -- R2
A6 := [ 0, 0, 0,-1, 0, 0, 0]; -- Y2
A7 := [ 0, 1, 0,-1, 0, 0, 0]; -- B2 
 ------------------------------------------

  ------- region B: train constraints ------
B0 := [ 0, 0, 0, 1, 0,-1, 0]; -- G1
B1 := [ 0, 0, 0, 1, 0,-1, 0]; -- R1
B2 := [ 0, 0, 1,-1, 0, 0, 0]; -- Y1
B3 := [ 0, 0, 1,-1, 0, 1, 0]; -- B1
B4 := [ 0, 1, 0, 0,-1, 0, 0]; -- G2
B5 := [ 0, 1, 0, 0,-1, 0, 0]; -- R2
B6 := [ 0, 1, 0,-1, 0, 0, 0]; -- Y2
B7 := [ 0, 0, 0,-1, 0, 0, 0]; -- B2
  ------------------------------------------
 
LA := 7;
LB := 7;
  
IVAR
  -- (unfair) selector of the train transition
  RUNNING: {0,1,2,3,4,5,6,7};

VAR
  -- vector of train progesses in the execution of their missions
  P0: 0..6;
  P1: 0..6;
  P2: 0..6;
  P3: 0..6;
  P4: 0..6;
  P5: 0..6;
  P6: 0..6;
  P7: 0..6;
  --
  --
  -- the occupation status for regions A and B
  RA:  0..8; 
  RB:  0..8;

ASSIGN
  -- the initial vector of train progesses
  init(P0) := 0;
  init(P1) := 0;
  init(P2) := 0;
  init(P3) := 0;
  init(P4) := 0;
  init(P5) := 0;
  init(P6) := 0;
  init(P7) := 0;
  --
  -- the initial occupation status for regions A and B
  init(RA) := 1;
  init(RB) := 1;
  
TRANS 
  -- progression rules for the evolving train 0
 
      RUNNING =0 &
        -- the current train has not yet completed its mission
        P0 < 6 &
        --
        -- the next place is not occupied by other trains
        T0[P0+1] !=  T1[P1] &
        T0[P0+1] !=  T2[P2] &
        T0[P0+1] !=  T3[P3] &
        T0[P0+1] !=  T4[P4] &
        T0[P0+1] !=  T5[P5] &
        T0[P0+1] !=  T6[P6] &
        T0[P0+1] !=  T7[P7] &
        -- 
        -- the progression step of id satisfies all contraints
        RA + A0[P0+1] <= LA &
        RB + B0[P0+1] <= LB 
      ?
        next(P0) in (P0+1) &
        next(P1) in P1 &
        next(P2) in P2 &
        next(P3) in P3 &
        next(P4) in P4 &
        next(P5) in P5 &
        next(P6) in P6 &
        next(P7) in P7 &
        next(RA) in (RA + A0[P0+1]) &
        next(RB) in (RB + B0[P0+1]) 
      : 
      RUNNING = 1 &
        P1 < 6 &
        T1[P1+1] !=  T0[P0] &
        T1[P1+1] !=  T2[P2] &
        T1[P1+1] !=  T3[P3] &
        T1[P1+1] !=  T4[P4] &
        T1[P1+1] !=  T5[P5] &
        T1[P1+1] !=  T6[P6] &
        T1[P1+1] !=  T7[P7] &
        RA + A1[P1+1] <= LA &
        RB + B1[P1+1] <= LB 
      ? 
        next(P0) in P0 &
        next(P1) in (P1+1) &
        next(P2) in P2 &
        next(P3) in P3 &
        next(P4) in P4 &
        next(P5) in P5 &
        next(P6) in P6 &
        next(P7) in P7 &
        next(RA) in (RA + A1[P1+1]) &
        next(RB) in (RB + B1[P1+1])    
     : 
      RUNNING =2 &
        P2 < 6 &
        T2[P2+1] !=  T0[P0] &
        T2[P2+1] !=  T1[P1] &
        T2[P2+1] !=  T3[P3] &
        T2[P2+1] !=  T4[P4] &
        T2[P2+1] !=  T5[P5] &
        T2[P2+1] !=  T6[P6] &
        T2[P2+1] !=  T7[P7] &
        RA + A2[P2+1] <= LA &
        RB + B2[P2+1] <= LB
      ?
        next(P0) in P0 &
        next(P1) in P1 &
        next(P2) in (P2+1) &
        next(P3) in P3 &
        next(P4) in P4 &
        next(P5) in P5 &
        next(P6) in P6 &
        next(P7) in P7 &
        next(RA) in (RA + A2[P2+1]) &
        next(RB) in (RB + B2[P2+1])    
    :
     RUNNING =3 &
        P3 < 6 &
        T3[P3+1] !=  T0[P0] &
        T3[P3+1] !=  T1[P1] &
        T3[P3+1] !=  T2[P2] &
        T3[P3+1] !=  T3[P3] &
        T3[P3+1] !=  T4[P4] &
        T3[P3+1] !=  T5[P5] &
        T3[P3+1] !=  T6[P6] &
        T3[P3+1] !=  T7[P7] &
        RA + A3[P3+1] <= LA &
        RB + B3[P3+1] <= LB 
    ?
        next(P0) in P0 &
        next(P1) in P1 &
        next(P2) in P2 &
        next(P3) in (P3+1) &
        next(P4) in P4 &
        next(P5) in P5 &
        next(P6) in P6 &
        next(P7) in P7 &
        next(RA) in (RA + A3[P3+1]) &
        next(RB) in (RB + B3[P3+1]) 
   
    :
     RUNNING =4 &
        P4 < 6 &
        T4[P4+1] !=  T0[P0] &
        T4[P4+1] !=  T1[P1] &
        T4[P4+1] !=  T2[P2] &
        T4[P4+1] !=  T3[P3] &
        T4[P4+1] !=  T4[P4] &
        T4[P4+1] !=  T5[P5] &
        T4[P4+1] !=  T6[P6] &
        T4[P4+1] !=  T7[P7] &
        RA + A4[P4+1] <= LA &
        RB + B4[P4+1] <= LB
    ?
        next(P0) in P0 &
        next(P1) in P1 &
        next(P2) in P2 &
        next(P3) in P3 &
        next(P4) in (P4+1) &
        next(P5) in P5 &
        next(P6) in P6 &
        next(P7) in P7 &
        next(RA) in (RA + A4[P4+1]) &
        next(RB) in (RB + B4[P4+1]) 
    :
     RUNNING =5 &
        P5 < 6 &
        T5[P5+1] !=  T0[P0] &
        T5[P5+1] !=  T1[P1] &
        T5[P5+1] !=  T2[P2] &
        T5[P5+1] !=  T3[P3] &
        T5[P5+1] !=  T4[P4] &
        T5[P5+1] !=  T6[P6] &
        T5[P5+1] !=  T7[P7] &
        RA + A5[P5+1] <= LA &
        RB + B5[P5+1] <= LB 
    ?
        next(P0) in P0 &
        next(P1) in P1 &
        next(P2) in P2 &
        next(P3) in P3 &
        next(P4) in P4 &
        next(P5) in (P5+1) &
        next(P6) in P6 &
        next(P7) in P7 &
        next(RA) in (RA + A5[P5+1]) &
        next(RB) in (RB + B5[P5+1]) 
    :
      RUNNING = 6 &
        P6 < 6 &
        T6[P6+1] !=  T0[P0] &
        T6[P6+1] !=  T1[P1] &
        T6[P6+1] !=  T2[P2] &
        T6[P6+1] !=  T3[P3] &
        T6[P6+1] !=  T4[P4] &
        T6[P6+1] !=  T5[P5] &
        T6[P6+1] !=  T6[P6] &
        T6[P6+1] !=  T7[P7] &
        RA + A6[P6+1] <= LA &
        RB + B6[P6+1] <= LB
    ?
        next(P0) in P0 &
        next(P1) in P1 &
        next(P2) in P2 &
        next(P3) in P3 &
        next(P4) in P4 &
        next(P5) in P5 &
        next(P6) in (P6+1) &
        next(P7) in P7 &
        next(RA) in (RA + A6[P6+1]) &
        next(RB) in (RB + B6[P6+1])  
    :
     RUNNING =7 &
        -- the current train has not yet completed its mission
        P7 < 6 &
        --
        -- the next place is not occupied by other trains
        T7[P7+1] !=  T0[P0] &
        T7[P7+1] !=  T1[P1] &
        T7[P7+1] !=  T2[P2] &
        T7[P7+1] !=  T3[P3] &
        T7[P7+1] !=  T4[P4] &
        T7[P7+1] !=  T5[P5] &
        T7[P7+1] !=  T6[P6] &
        T7[P7+1] !=  T7[P7] &
        -- 
        -- the progression step of id satisfies all contraints
        RA + A7[P7+1] <= LA &
        RB + B7[P7+1] <= LB 
    ?
        next(P0) in P0 &
        next(P1) in P1 &
        next(P2) in P2 &
        next(P3) in P3 &
        next(P4) in P4 &
        next(P5) in P5 &
        next(P6) in P6 &
        next(P7) in (P7+1) &
        next(RA) in (RA + A7[P7+1]) &
        next(RB) in (RB + B7[P7+1])
   :  
        next(P0) in P0 &
        next(P1) in P1 &
        next(P2) in P2 &
        next(P3) in P3 &
        next(P4) in P4 &
        next(P5) in P5 &
        next(P6) in P6 &
        next(P7) in P7 &
        next(RA) in RA &
        next(RB) in RB

-- FAIRNESS  RUNNING = 0;
-- FAIRNESS  RUNNING = 1;
-- FAIRNESS  RUNNING = 2;
-- FAIRNESS  RUNNING = 3;
-- FAIRNESS  RUNNING = 4;
-- FAIRNESS  RUNNING = 5;
-- FAIRNESS  RUNNING = 6;
-- FAIRNESS  RUNNING = 7;
 
-- CTLSPEC
--   AF ((P0=6) & (P1=6) & (P2=6) & (P3=6) &  (P4=6) & (P5=6) & (P6=6) & (P7=6))
   
-- LTLSPEC
--   F ((P0=6) & (P1=6) & (P2=6) & (P3=6) &  (P4=6) & (P5=6) & (P6=6) & (P7=6))

CTLSPEC 
  AG EF ((P0=6) & (P1=6) & (P2=6) & (P3=6) &  (P4=6) & (P5=6) & (P6=6) & (P7=6))
  
-------------------------------- end main -------------------------------------------
-------------------------------------------------------------------------------------

----------------------------------------
--    Batch Verification:
----------------------------------------
-- time nusmv -r -v 1 smv_oneway8-SM.smv
--    FAIRNESS RUNNING = 1; ... RUNNING = 7;
--    LTLSPEC    F ((0=6) & ... & P7=6))
-- > 
-- > reachable states: 1.63654e+06 (2^20.6422) out of 4.66949e+08 (2^28.7987)
-- > Successful termination
-- > real	0m43.609s
-- > user	0m43.431s
----------------------------------------
-- time nusmv -r -v 1 smv_oneway8-SM.smv
--    FAIRNESS RUNNING = 1; ... RUNNING = 7;
--    CTLSPEC   AF ((0=6) & ... & P7=6))
-- > 
-- > reachable states: 1.63654e+06 (2^20.6422) out of 4.66949e+08 (2^28.7987)
-- > Successful termination
-- > real	0m39.211s
-- > user	0m39.015s
----------------------------------------
-- time nusmv -r -v 1 smv_oneway8-SM.smv
--    CTLSPEC   AG EF ((0=6) & ... & P7=6))
-- > 
-- > reachable states: 1.63654e+06 (2^20.6422) out of 4.66949e+08 (2^28.7987)
-- > Successful termination
-- > real	0m2.807s
-- > user	0m2.771s
-- > USED MEMORY  74 MB

----------------------------------------
-- nusmv -v 2 -ctt -r -is smv_oneway8-SM.smv
--    -ctt checks totatlity of transition relation function
--    -r  prints actual number of reachable states 
--    -v 1   verbose (1..4)
--    -is   ignore SPEC properties
--    -AG   used ad hoc algorithm for AG-only properties
-- nusmv -v 1 -bmc -bmc_length 100 cyclic8-smv.txt 
------------------------------------------
--    Interactive Verification:
-- ./NuSMV -int
-- read_model -i smv_oneway8-SM.smv
-- flatten_hierarchy
-- encode_variables
-- build_model
-- check_ctlspec -p "AF (P0 = 0)"
--------------- other commands --------
--check_ctlspec [-h] [-m | -o output-file] [-n number | -p
-- "ctl-expr  [IN context]" | -P "name"]
--go
--pick_state -i
--simulate -i
---------------------------------------
\end{verbatim}
}

\section{SPIN}

{\scriptsize
\begin{verbatim}

/*  TRAIN MISSION DATA */
byte T0[14];
byte T1[14];
byte T2[14];
byte T3[14];
byte T4[14];
byte T5[14];
byte T6[14];
byte T7[14];

/* TRAIN PROGRESS DATA */
byte P0,P1,P2,P3,P4,P5,P6,P7;

/*  CONSTRAINTs DATA  FOR REGIONS A,B  */
byte RA; // occupancy of region A
byte RB; // occupancy of region B
byte LA; // limit of region A
byte LB; // limit if region B
short A0[14]; // Constraints of Train 0 for Region A
short A1[14]; // Constraints of Train 1 for Region A
short A2[14]; // Constraints of Train 2 for Region A
short A3[14]; //          ...
short A4[14];
short A5[14];
short A6[14];
short A7[14];
short B0[14]; // Constraints of Train 0 for Region B
short B1[14]; // Constraints of Train 1 for Region B
short B2[14]; // Constraints of Train 2 for Region B
short B3[14]; //          ...
short B4[14];
short B5[14];
short B6[14];
short B7[14];

/*  INITIALIZATIONS */
init {
  atomic {

//--------------------------------------------------------------
// T0 := [ 1, 9,10,13,15,20,23,22]; -- G1
// T1 := [ 3, 9,10,13,15,20,24,22]; -- R1
// T2 := [ 5,27,11,13,16,20,25,22]; -- Y1
// T3 := [ 7,27,11,13,16,20,26,22]; -- B1
// T4 := [23,22,17,18,11, 9, 2, 1]; -- G2
// T5 := [24,22,17,18,11, 9, 4, 3]; -- R2
// T6 := [25,22,17,18,12,27, 6, 5]; -- Y2
// T7 := [26,22,17,18,12,27, 8, 7]; -- B2
//--------------------------------------------------------------
  T0[0]= 1; T0[1]= 9; T0[2]=10; T0[3]=13; T0[4]=15; T0[5]=20; T0[6]=23;
  T1[0]= 3; T1[1]=9;  T1[2]=10; T1[3]=13; T1[4]=15; T1[5]=20; T1[6]=24;
  T2[0]= 5; T2[1]=27; T2[2]=11; T2[3]=13; T2[4]=16; T2[5]=20; T2[6]=25;
  T3[0]= 7; T3[1]=27; T3[2]=11; T3[3]=13; T3[4]=16; T3[5]=20; T3[6]=26;
  T4[0]=23; T4[1]=22; T4[2]=17; T4[3]=18; T4[4]=11; T4[5]= 9; T4[6]= 2;
  T5[0]=24; T5[1]=22; T5[2]=17; T5[3]=18; T5[4]=11; T5[5]= 9; T5[6]= 4;
  T6[0]=25; T6[1]=22; T6[2]=17; T6[3]=18; T6[4]=12; T6[5]=27; T6[6]= 6;
  T7[0]=26; T7[1]=22; T7[2]=17; T7[3]=18; T7[4]=12; T7[5]=27; T7[6]= 8;

//  
// ------ initial train positions   --------
//  Pi=0 as default value. no need of explicit initialization

// ------ region A: train constraints ------
   A0[3] = 1; A0[5] = -1; A0[ 7]=  1; A0[10] = -1;
   A1[3] = 1; A1[5] = -1; A1[ 7]=  1; A1[10] = -1;
   A2[2] = 1; A2[3] = -1; A2[ 5]=  1; A2[ 9] = -1;
   A3[2] = 1; A3[3] = -1; A3[ 7]=  1; A3[ 9] = -1;
   A4[1] = 1; A4[4] = -1; A4[10]=  1; A4[12] = -1;
   A5[1] = 1; A5[4] = -1; A5[10]=  1; A5[12] = -1;
   A6[3] =-1; A6[ 9] = 1; A6[10]= -1; A6[12] =  1;
   A7[1] = 1; A7[3] = -1; A7[ 9]=  1; A7[10] = -1;
   
// ------- region B: train constraints ------
   B0[3] =  1; B0[5] = -1; B0[ 7] =  1; B0[10] = -1;
   B1[3] =  1; B1[5] = -1; B1[ 7] =  1; B1[10] = -1;
   B2[2] =  1; B2[3] = -1; B2[ 7] =  1; B2[ 9] = -1;
   B3[2] =  1; B3[3] = -1; B3[ 5] =  1; B3[ 9] = -1;
   B4[1] =  1; B4[4] = -1; B4[10] =  1; B4[12] = -1;
   B5[1] =  1; B5[4] = -1; B5[10] =  1; B5[12] = -1;
   B6[1] =  1; B6[3] = -1; B6[ 9] =  1; B6[10] = -1;
   B7[3] = -1; B7[9] =  1; B7[10] = -1; B7[12] =  1;

   RA = 1;
   RB = 1;
   LA =7;
   LB =7;
  }
   do
    :: atomic {
       (P0 < 6 &&
        T0[P0+1] != T1[P1] && // next place of train0 not occupied by train1
        T0[P0+1] != T2[P2] && // next place of train0 not occupied by train2
        T0[P0+1] != T3[P3] &&
        T0[P0+1] != T4[P4] &&
        T0[P0+1] != T5[P5] &&
        T0[P0+1] != T6[P6] &&
        T0[P0+1] != T7[P7] && // next place of train0 not occupied by train7
        (RA + A0[P0+1]) <= LA && // progress of train0 does not saturate RA 
        (RB + B0[P0+1]) <= LB    // progress of train0 does not saturate RB 
       ) ->  
         P0 = (P0+1); 
         RA = RA + A0[P0];   // update occupancy of RA according to the step
         RB = RB + B0[P0];   // update occupancy of RB according to the step
       };  
    :: atomic {
       (P1 < 6 &&
        T1[P1+1] != T0[P0] &&
        T1[P1+1] != T2[P2] &&
        T1[P1+1] != T3[P3] &&
        T1[P1+1] != T4[P4] &&
        T1[P1+1] != T5[P5] &&
        T1[P1+1] != T6[P6] &&
        T1[P1+1] != T7[P7] &&
        (RA + A1[P1+1]) <= LA &&
        (RB + B1[P1+1]) <= LB    // progress of train0 does not saturate RD 
       ) ->  
         P1 = (P1+1); 
         RA = RA + A1[P1];  
         RB = RB + B1[P1];  
       };
    :: atomic {
       (P2 < 6 &&
        T2[P2+1] != T0[P0] &&
        T2[P2+1] != T1[P1] &&
        T2[P2+1] != T3[P3] &&
        T2[P2+1] != T4[P4] &&
        T2[P2+1] != T5[P5] &&
        T2[P2+1] != T6[P6] &&
        T2[P2+1] != T7[P7] &&
        (RA + A2[P2+1]) <= LA &&
        (RB + B2[P2+1]) <= LB 
       ) ->  
         P2 = (P2+1); 
         RA = RA + A2[P2];   // update occupancy of RA according to the step
         RB = RB + B2[P2]; 
       };
    :: atomic {
       (P3 < 6 &&
        T3[P3+1] != T0[P0] &&
        T3[P3+1] != T1[P1] &&
        T3[P3+1] != T2[P2] &&
        T3[P3+1] != T4[P4] &&
        T3[P3+1] != T5[P5] &&
        T3[P3+1] != T6[P6] &&
        T3[P3+1] != T7[P7] &&
        (RA + A3[P3+1]) <= LA &&
        (RB + B3[P3+1]) <= LB 
       ) ->  
         P3 = (P3+1); 
         RA = RA + A3[P3];   // update occupancy of RA according to the step
         RB = RB + B3[P3]; 
       };
    :: atomic {
       (P4 < 6 &&
        T4[P4+1] != T0[P0] &&
        T4[P4+1] != T1[P1] &&
        T4[P4+1] != T2[P2] &&
        T4[P4+1] != T3[P3] &&
        T4[P4+1] != T5[P5] &&
        T4[P4+1] != T6[P6] &&
        T4[P4+1] != T7[P7] &&
        (RA + A4[P4+1]) <= LA &&
        (RB + B4[P4+1]) <= LB 
       ) ->  
         P4 = (P4+1); 
         RA = RA + A4[P4];   // update occupancy of RA according to the step
         RB = RB + B4[P4];
       };
    :: atomic {
       (P5 < 6 &&
        T5[P5+1] != T0[P0] &&
        T5[P5+1] != T1[P1] &&
        T5[P5+1] != T2[P2] &&
        T5[P5+1] != T3[P3] &&
        T5[P5+1] != T4[P4] &&
        T5[P5+1] != T6[P6] &&
        T5[P5+1] != T7[P7] &&
        (RA + A5[P5+1]) <= LA &&
        (RB + B5[P5+1]) <= LB  
       ) ->  
         P5 = (P5+1);  
         RA = RA + A5[P5];   // update occupancy of RA according to the step
         RB = RB + B5[P5]; 
       };
    :: atomic {
       (P6 < 6 &&
        T6[P6+1] != T0[P0] &&
        T6[P6+1] != T1[P1] &&
        T6[P6+1] != T2[P2] &&
        T6[P6+1] != T3[P3] &&
        T6[P6+1] != T4[P4] &&
        T6[P6+1] != T5[P5] &&
        T6[P6+1] != T7[P7] &&
        (RA + A6[P6+1]) <= LA &&
        (RB + B6[P6+1]) <= LB 
       ) ->  
         P6 = (P6+1); 
         RA = RA + A6[P6];   // update occupancy of RA according to the step
         RB = RB + B6[P6]; 
       };
    :: atomic {
       (P7 < 6 &&
        T7[P7+1] != T0[P0] &&
        T7[P7+1] != T1[P1] &&
        T7[P7+1] != T2[P2] &&
        T7[P7+1] != T3[P3] &&
        T7[P7+1] != T4[P4] &&
        T7[P7+1] != T5[P5] &&
        T7[P7+1] != T6[P6] &&
        (RA + A7[P7+1]) <= LA &&
        (RB + B7[P7+1]) <= LB 
       ) ->  
         P7 = (P7+1); 
         RA = RA + A7[P7];   // update occupancy of RA according to the step
         RB = RB + B7[P7]; 
       };
 :: (P0 == 6) && (P1 == 6) && (P2 == 6) && (P3 == 6) &&
    (P4 == 6) && (P5 == 6) && (P6 == 6) && (P7 == 6) -> skip;
  od;
}

/*  PROPERTIES */
 ltl p1 
 { <> ((P0==6) && (P1==6) && (P2==6) && (P3==6) &&
       (P4==6) && (P5==6) && (P6==6) && (P7==6)) }
       
/*   verfication process
  // DEPTH FIRST 
  spin -a spin_oneway8small.pml
  gcc -O3 -o pan pan.c 
  time pan -a 
  > 
  > Full statespace search for:
  >     never claim         	+ (p1)
  >
  >     1636546 states, stored
  >     7134234 transitions
  >   
  > real	0m13.110s
  > user	0m12.683s
  > sys	0m0.411s
  > USED VIRTUAL MEMORY (pan):  1.02 GB

  // BREADTH FIRST
  spin -a spin_oneway8.pml
  gcc -O3 -DBFS -DBFS_DISK -DVECTORSZ=256000  -o pan pan.c
  gcc -O3 -DBFS -DVECTORSZ=256000  -o pan pan.c 
  time pan -m500000 -v -w33
  >
  > Full statespace search for:
  >	never claim         	+ (p1)
  >    
  >    1636545 states, stored
  >     7134237 transitions
  >
  > real	1m3.582s
  > user	0m31.621s
  > sys	 	0m29.806s

*/

/*   other commands
  spin -t[N] -- follow [Nth] simulation trail, see also -k
  pan -c0  -- counts all errors
  pan -c   -- saves in the trail file the info for 3rd error
  pan -e -c0 -- saves all errors trails each one in file specI.trail
  spin -k specI.trail -c spec.pml -- displays the trail for error I
  pan -r trailfilename   --read and execute trail in file
  pan -rN    --   read and execute N-th error trail
  pan -C  --  read and execute trail - columnated output (can add -v,-n)
  pan -r -PN read and execute trail - restrict trail output to proc N
  pan -     (for help on options)  
  pan -w32 -v  -D (dot format!)
  ------
*/

\end{verbatim}
}

\section{TLA+}

{\scriptsize
\begin{verbatim}
------------------ MODULE oneway ---------------
EXTENDS Integers

VARIABLE 
  P0,P1,P2,P3,P4,P5,P6,P7,RA,RB
  
vars == <<P0,P1,P2,P3,P4,P5,P6,P7,RA,RB>>

TypesOK  == (P0 \in 0..6)

T0 == << 1, 9,10,13,15,20,23>>
T1 == << 3, 9,10,13,15,20,24>>
T2 == << 5,27,11,13,16,20,25>>
T3 == << 7,27,11,13,16,20,26>>
T4 == <<23,22,17,18,11, 9, 2>>
T5 == <<24,22,17,18,11, 9, 4>>
T6 == <<25,22,17,18,12,27, 6>>
T7 == <<26,22,17,18,12,27, 8>>

A0 == << 0, 0, 0, 1, 0,-1, 0>>
A1 == << 0, 0, 0, 1, 0,-1, 0>>
A2 == << 0, 0, 1,-1, 0, 1, 0>>
A3 == << 0, 0, 1,-1, 0, 0, 0>>
A4 == << 0, 1, 0, 0,-1, 0, 0>>
A5 == << 0, 1, 0, 0,-1, 0, 0>>
A6 == << 0, 0, 0,-1, 0, 0, 0>>
A7 == << 0, 1, 0,-1, 0, 0, 0>>

B0 == << 0, 0, 0, 1, 0,-1, 0>>
B1 == << 0, 0, 0, 1, 0,-1, 0>>
B2 == << 0, 0, 1,-1, 0, 0, 0>>
B3 == << 0, 0, 1,-1, 0, 1, 0>>
B4 == << 0, 1, 0, 0,-1, 0, 0>>
B5 == << 0, 1, 0, 0,-1, 0, 0>>
B6 == << 0, 1, 0,-1, 0, 0, 0>>
B7 == << 0, 0, 0,-1, 0, 0, 0>>

LA == 7
LB == 7

LL == 6

Init== 
/\ P0=0 /\ P1=0 /\ P2=0 /\ P3=0 /\ P4=0 /\ P5=0 /\ P6=0 /\ P7=0 
/\ RA=1 /\ RB=1

Move0 ==
   /\ P0 < LL 
   /\ T0[P0+2] /= T1[P1+1]
   /\ T0[P0+2] /= T2[P2+1]
   /\ T0[P0+2] /= T3[P3+1]
   /\ T0[P0+2] /= T4[P4+1]
   /\ T0[P0+2] /= T5[P5+1]
   /\ T0[P0+2] /= T6[P6+1]
   /\ T0[P0+2] /= T7[P7+1]
   /\ RA + A0[P0+2] <= LA
   /\ RB + B0[P0+2] <= LB
   /\ P0' = (P0+1)
   /\ RA' = RA + A0[P0+2]
   /\ RB' = RB + B0[P0+2]
   /\ UNCHANGED <<P1,P2,P3,P4,P5,P6,P7>>


Move1 ==
   /\ P1 < LL 
   /\ T1[P1+2] /= T0[P0+1]
   /\ T1[P1+2] /= T2[P2+1]
   /\ T1[P1+2] /= T3[P3+1]
   /\ T1[P1+2] /= T4[P4+1]
   /\ T1[P1+2] /= T5[P5+1]
   /\ T1[P1+2] /= T6[P6+1]
   /\ T1[P1+2] /= T7[P7+1]
   /\ RA + A1[P1+2] <= LA
   /\ RB + B1[P1+2] <= LB
   /\ P1' = (P1+1)
   /\ RA' = RA + A1[P1+2]
   /\ RB' = RB + B1[P1+2]
   /\ UNCHANGED <<P0,P2,P3,P4,P5,P6,P7>>
   

Move2 ==
   /\ P2 < LL 
   /\ T2[P2+2] /= T0[P0+1]
   /\ T2[P2+2] /= T1[P1+1]
   /\ T2[P2+2] /= T3[P3+1]
   /\ T2[P2+2] /= T4[P4+1]
   /\ T2[P2+2] /= T5[P5+1]
   /\ T2[P2+2] /= T6[P6+1]
   /\ T2[P2+2] /= T7[P7+1]
   /\ RA + A2[P2+2] <= LA
   /\ RB + B2[P2+2] <= LB
   /\ P2' = (P2+1)
   /\ RA' = RA + A2[P2+2]
   /\ RB' = RB + B2[P2+2]
   /\ UNCHANGED <<P0,P1,P3,P4,P5,P6,P7>>
   

Move3 ==
   /\ P3 < LL 
   /\ T3[P3+2] /= T0[P0+1]
   /\ T3[P3+2] /= T1[P1+1]
   /\ T3[P3+2] /= T2[P2+1]
   /\ T3[P3+2] /= T4[P4+1]
   /\ T3[P3+2] /= T5[P5+1]
   /\ T3[P3+2] /= T6[P6+1]
   /\ T3[P3+2] /= T7[P7+1]
   /\ RA + A3[P3+2] <= LA
   /\ RB + B3[P3+2] <= LB
   /\ P3' = (P3+1)
   /\ RA' = RA + A3[P3+2]
   /\ RB' = RB + B3[P3+2]
   /\ UNCHANGED <<P0,P1,P2,P4,P5,P6,P7>>
     
Move4 ==
   /\ P4 < LL 
   /\ T4[P4+2] /= T0[P0+1]
   /\ T4[P4+2] /= T1[P1+1]
   /\ T4[P4+2] /= T2[P2+1]
   /\ T4[P4+2] /= T3[P3+1]
   /\ T4[P4+2] /= T5[P5+1]
   /\ T4[P4+2] /= T6[P6+1]
   /\ T4[P4+2] /= T7[P7+1]
   /\ RA + A4[P4+2] <= LA
   /\ RB + B4[P4+2] <= LB
   /\ P4' = (P4+1)
   /\ RA' = RA + A4[P4+2]
   /\ RB' = RB + B4[P4+2]
   /\ UNCHANGED <<P0,P1,P2,P3,P5,P6,P7>>
   

Move5 ==
   /\ P5 < LL 
   /\ T5[P5+2] /= T0[P0+1]
   /\ T5[P5+2] /= T1[P1+1]
   /\ T5[P5+2] /= T2[P2+1]
   /\ T5[P5+2] /= T3[P3+1]
   /\ T5[P5+2] /= T4[P4+1]
   /\ T5[P5+2] /= T6[P6+1]
   /\ T5[P5+2] /= T7[P7+1]
   /\ RA + A5[P5+2] <= LA
   /\ RB + B5[P5+2] <= LB
   /\ P5' = (P5+1)
   /\ RA' = RA + A5[P5+2]
   /\ RB' = RB + B5[P5+2]
   /\ UNCHANGED <<P0,P1,P2,P3,P4,P6,P7>>
   
Move6 ==
   /\ P6 < LL 
   /\ T6[P6+2] /= T0[P0+1]
   /\ T6[P6+2] /= T1[P1+1]
   /\ T6[P6+2] /= T2[P2+1]
   /\ T6[P6+2] /= T3[P3+1]
   /\ T6[P6+2] /= T4[P4+1]
   /\ T6[P6+2] /= T5[P5+1]
   /\ T6[P6+2] /= T7[P7+1]
   /\ RA + A6[P6+2] <= LA
   /\ RB + B6[P6+2] <= LB
   /\ P6' = (P6+1)
   /\ RA' = RA + A6[P6+2]
   /\ RB' = RB + B6[P6+2]
   /\ UNCHANGED <<P0,P1,P2,P3,P4,P5,P7>>
   
   
Move7 ==
   /\ P7 < LL 
   /\ T7[P7+2] /= T0[P0+1]
   /\ T7[P7+2] /= T1[P1+1]
   /\ T7[P7+2] /= T2[P2+1]
   /\ T7[P7+2] /= T3[P3+1]
   /\ T7[P7+2] /= T4[P4+1]
   /\ T7[P7+2] /= T5[P5+1]
   /\ T7[P7+2] /= T6[P6+1]
   /\ RA + A7[P7+2] <= LA
   /\ RB + B7[P7+2] <= LB
   /\ P7' = (P7+1)
   /\ RA' = RA + A7[P7+2]
   /\ RB' = RB + B7[P7+2]
   /\ UNCHANGED <<P0,P1,P2,P3,P4,P5,P6>>
   
Next== 
  \/  Move0 \/  Move1 \/  Move2 \/  Move3
  \/  Move4 \/  Move5 \/  Move6 \/  Move7
    
Arrived == 
  /\ (P0=LL) /\ (P1=LL) /\ (P2=LL) /\ (P3=LL)
  /\ (P4=LL) /\ (P5=LL) /\ (P6=LL) /\ (P7=LL)
 
Property == <>Arrived
  
Spec == Init /\ [][Next]_vars 
SFairSpec == Init /\ [][Next]_vars /\ SF_vars (Next)    (*for LTL verification*)

(**************************************************)
(* Property: <>Arrived,  Behavior Spec: SFairSpec *)
(* States: 1636545, Result: TRUE, Time 3m17s      *)
(**************************************************)

(* Model Overview:  setting Temporal formula == "Spec" *)
(* Deadlock Found:  trace for  P0=6 & P4=6 *)
(* PROPERTIES: <>Arrivedis FALSE, because of implicit stuttering*)

(* Model Overview: setting Temporal formula == "SFairSpec" *)
(* Deadlock Found: trace for P0=6 & P4=6 (stuttering does not avoids deadlocks)*)
(* PROPERTIES: <>Arrived     is TRUE, stuttering ignored *)
===============================================

\end{verbatim}
}

\section{UMC}

{\scriptsize
\begin{verbatim}
Class REGION2 is
Vars:

---------------------------------------------------------------
T0: int[] := [ 1, 9,10,13,15,20,23]; -- G1
T1: int[] := [ 3, 9,10,13,15,20,24]; -- R1
T2: int[] := [ 5,27,11,13,16,20,25]; -- Y1
T3: int[] := [ 7,27,11,13,16,20,26]; -- B1
T4: int[] := [23,22,17,18,11, 9, 2]; -- G2
T5: int[] := [24,22,17,18,11, 9, 4]; -- R2
T6: int[] := [25,22,17,18,12,27, 6]; -- Y2
T7: int[] := [26,22,17,18,12,27, 8]; -- B2
----------------------------------------------------------------
P0: int :=0;
P1: int :=0;
P2: int :=0;
P3: int :=0;
P4: int :=0;
P5: int :=0;
P6: int :=0;
P7: int :=0;
----------------------------------------------------------------

------ region A: train constraints ------
A0: int[] := [ 0, 0, 0, 1, 0,-1, 0]; -- G1
A1: int[] := [ 0, 0, 0, 1, 0,-1, 0]; -- R1
A2: int[] := [ 0, 0, 1,-1, 0, 1, 0]; -- Y1
A3: int[] := [ 0, 0, 1,-1, 0, 0, 0]; -- B1
A4: int[] := [ 0, 1, 0, 0,-1, 0, 0]; -- G2
A5: int[] := [ 0, 1, 0, 0,-1, 0, 0]; -- R2
A6: int[] := [ 0, 0, 0,-1, 0, 0, 0]; -- Y2
A7: int[] := [ 0, 1, 0,-1, 0, 0, 0]; -- B2
------------------------------------------

------- region B: train constraints ------
B0: int[] := [ 0, 0, 0, 1, 0,-1, 0]; -- G1
B1: int[] := [ 0, 0, 0, 1, 0,-1, 0]; -- R1
B2: int[] := [ 0, 0, 1,-1, 0, 0, 0]; -- Y1
B3: int[] := [ 0, 0, 1,-1, 0, 1, 0]; -- B1
B4: int[] := [ 0, 1, 0, 0,-1, 0, 0]; -- G2
B5: int[] := [ 0, 1, 0, 0,-1, 0, 0]; -- R2
B6: int[] := [ 0, 1, 0,-1, 0, 0, 0]; -- Y2
B7: int[] := [ 0, 0, 0,-1, 0, 0, 0]; -- B2
------------------------------------------


-------------------------------------------------------------
RA: int :=1;  -- initial value for region RA
RB: int :=1;  -- initial value for region RB
LA: int :=7;  -- limit value for region RA
LB: int :=7;  -- limit value for region RB
-------------------------------------------------------------------

State Top =s1

Behavior:

------------------------- train 0 -----------------------------
s1 -> s1
 {- [P0 < 6 &
     T0[P0+1] != T1[P1] &
     T0[P0+1] != T2[P2] &
     T0[P0+1] != T3[P3] &
     T0[P0+1] != T4[P4] &
     T0[P0+1] != T5[P5] &
     T0[P0+1] != T6[P6] &
     T0[P0+1] != T7[P7] &
     RA + A0[P0+1] <= LA &
     RB + B0[P0+1] <= LB] /
  P0 := P0 +1;
  RA = RA + A0[P0];
  RB = RB + B0[P0];
 }

------------------------- train 1 -----------------------------
s1 -> s1 
 {- [P1 < 6 &
     T1[P1+1] != T0[P0] &
     T1[P1+1] != T2[P2] &
     T1[P1+1] != T3[P3] &
     T1[P1+1] != T4[P4] &
     T1[P1+1] != T5[P5] &
     T1[P1+1] != T6[P6] &
     T1[P1+1] != T7[P7] &
     RA + A1[P1+1] <= LA &
     RB + B1[P1+1] <= LB ] /
  P1 := P1 +1;
  RA = RA + A1[P1];
  RB = RB + B1[P1];
 }
     
------------------------- train 2 -----------------------------
s1 -> s1 
 {- [P2 < 6 &
     T2[P2+1] != T0[P0] &
     T2[P2+1] != T1[P1] &
     T2[P2+1] != T3[P3] &
     T2[P2+1] != T4[P4] &
     T2[P2+1] != T5[P5] &
     T2[P2+1] != T6[P6] &
     T2[P2+1] != T7[P7] &
     RA + A2[P2+1] <= LA &
     RB + B2[P2+1] <= LB ] /
  P2 := P2 +1;
  RA = RA + A2[P2];
  RB = RB + B2[P2];
 }

------------------------- train 3 -----------------------------
s1 -> s1 
 {- [P3 < 6 &
     T3[P3+1] != T0[P0] &
     T3[P3+1] != T1[P1] &
     T3[P3+1] != T2[P2] &
     T3[P3+1] != T4[P4] &
     T3[P3+1] != T5[P5] &
     T3[P3+1] != T6[P6] &
     T3[P3+1] != T7[P7] &
     RA + A3[P3+1] <= LA &
     RB + B3[P3+1] <= LB ] /
  P3 := P3 +1;
  RA = RA + A3[P3];
  RB = RB + B3[P3];
 }

------------------------- train 4 -----------------------------
s1 -> s1 
 {- [P4 < 6 &
     T4[P4+1] != T0[P0] &
     T4[P4+1] != T1[P1] &
     T4[P4+1] != T2[P2] &
     T4[P4+1] != T3[P3] &
     T4[P4+1] != T5[P5] &
     T4[P4+1] != T6[P6] &
     T4[P4+1] != T7[P7] &
     RA + A4[P4+1] <= LA &
     RB + B4[P4+1] <= LB ] /
  P4 := P4 +1;
  RA = RA + A4[P4];
  RB = RB + B4[P4];
 }

------------------------- train 5 -----------------------------
s1 -> s1 
 {- [P5 < 6 &
     T5[P5+1] != T0[P0] &
     T5[P5+1] != T1[P1] &
     T5[P5+1] != T2[P2] &
     T5[P5+1] != T3[P3] &
     T5[P5+1] != T4[P4] &
     T5[P5+1] != T6[P6] &
     T5[P5+1] != T7[P7] &
     RA + A5[P5+1] <= LA &
     RB + B5[P5+1] <= LB] /
  P5 := P5 +1;
  RA = RA + A5[P5];
  RB = RB + B5[P5];
 }

------------------------- train 6 -----------------------------
s1 -> s1 
 {- [P6 < 6 &
     T6[P6+1] != T0[P0] &
     T6[P6+1] != T1[P1] &
     T6[P6+1] != T2[P2] &
     T6[P6+1] != T3[P3] &
     T6[P6+1] != T4[P4] &
     T6[P6+1] != T5[P5] &
     T6[P6+1] != T7[P7] &
     RA + A6[P6+1] <= LA &
     RB + B6[P6+1] <= LB ] /
  P6 := P6 +1;
  RA = RA + A6[P6];
  RB = RB + B6[P6];
 } 

------------------------- train 7 -----------------------------
s1 -> s1 
 {- [P7 < 6 &
     T7[P7+1] != T0[P0] &
     T7[P7+1] != T1[P1] &
     T7[P7+1] != T2[P2] &
     T7[P7+1] != T3[P3] &
     T7[P7+1] != T4[P4] &
     T7[P7+1] != T5[P5] &
     T7[P7+1] != T6[P6] &
     RA + A7[P7+1] <= LA &
     RB + B7[P7+1] <= LB ] /
  P7 := P7 +1;
  RA = RA + A7[P7];
  RB = RB + B7[P7];
 }

------------------------- termination -----------------------------
 s1 -> s1 
 {- [(P0=6) and (P1=6) and (P2=6) and (P3=6)&
     (P4=6) and (P5=6) and (P6=6) and (P7=6)] / ARRIVED}
 
end REGION2;

Objects:
 Count: Token;
 SYS: REGION2;

Abstractions {
 Action ARRIVED -> ARRIVED
 Action Error -> Error
-- State: 
--   SYS.P0=0 and
--   SYS.P1=0 and
--   SYS.P2=0 and
--   SYS.P3=0 and
--   SYS.P4=0 and
--   SYS.P5=0 and
--   SYS.P6=0 and
--   SYS.P7=0 -> Home  -- abstract label on final state
}

-- time umc -m3 -100 umc_oneway8.txt AFARR.txt
--
-- > The Formula: "AF {ARRIVED} true"
-- > is: TRUE 
-- > statspace stats: states generated= 1636545 ... evaluation time= 37.538 sec.
--
-- > real	0m36.980s
-- > user	1m23.800s
-- > sys	0m1.735s
-- USED VIRTUAL MEMORY: 2.98G
--
-- time mcstats -m3 umc_oneway8.txt
--
--  AFARR==   "AF {ARRIVED} true"
-------------------------------------------------------------------
-------------------------------------------------------------------


\end{verbatim}
}

\section{UPPAAL}

{\scriptsize
\begin{verbatim}
//
//  global declarations
//

//------- train missions ------
const int T0[7] = { 1, 9,10,13,15,20,23};
const int T1[7] = { 3, 9,10,13,15,20,24};
const int T2[7] = { 5,27,11,13,16,20,25};
const int T3[7] = { 7,27,11,13,16,20,26};
const int T4[7] = {23,22,17,18,11, 9, 2};
const int T5[7] = {24,22,17,18,11, 9, 4};
const int T6[7] = {25,22,17,18,12,27, 6};
const int T7[7] = {26,22,17,18,12,27, 8};

const int LA =7;  // limit value for region RA
const int LB =7;  // limit value for region RB

//------- region A: train constraints ------
const int A0[7] = { 0, 0, 0, 1, 0,-1, 0}; //G1
const int A1[7] = { 0, 0, 0, 1, 0,-1, 0}; // R1
const int A2[7] = { 0, 0, 1,-1, 0, 1, 0}; // Y1
const int A3[7] = { 0, 0, 1,-1, 0, 0, 0}; // B1
const int A4[7] = { 0, 1, 0, 0,-1, 0, 0}; // G2
const int A5[7] = { 0, 1, 0, 0,-1, 0, 0}; // R2
const int A6[7] = { 0, 0, 0,-1, 0, 0, 0}; // Y2
const int A7[7] = { 0, 1, 0,-1, 0, 0, 0}; // B2

//------- region B: train constraints ------
const int B0[7] = { 0, 0, 0, 1, 0,-1, 0}; // G1
const int B1[7] = { 0, 0, 0, 1, 0,-1, 0}; // R1
const int B2[7] = { 0, 0, 1,-1, 0, 0, 0}; // Y1
const int B3[7] = { 0, 0, 1,-1, 0, 1, 0}; // B1
const int B4[7] = { 0, 1, 0, 0,-1, 0, 0}; // G2
const int B5[7] = { 0, 1, 0, 0,-1, 0, 0}; // R2
const int B6[7] = { 0, 1, 0,-1, 0, 0, 0}; // Y2
const int B7[7] = { 0, 0, 0,-1, 0, 0, 0}; // B2
//------------------------------------------

int P0 := 0;
int P1 := 0;
int P2 := 0;
int P3 := 0;
int P4 := 0;
int P5 := 0;
int P6 := 0;
int P7 := 0;
int RA :=1;  // initial value for region RA
int RB :=1;  // initial value for region RB

broadcast chan move0,move1,move2,move3,move4,move5,move6,move7;

//------------  template defintions ---------
process Uppaal_Model() {
state s0;
urgent s0;
init s0;
trans 
  s0 -> s0 {
  guard 
    P0  < 6 &&
    T0[P0+1] != T1[P1] &&
    T0[P0+1] != T2[P2] &&
    T0[P0+1] != T3[P3] &&
    T0[P0+1] != T4[P4] &&
    T0[P0+1] != T5[P5] &&
    T0[P0+1] != T6[P6] &&
    T0[P0+1] != T7[P7] &&
    RA + A0[P0+1] <= LA  &&
    RB + B0[P0+1] <= LB;
  sync move0!;
  assign
	P0 := P0+1, 
    RA := RA + A0[P0],
    RB := RB + B0[P0];
  },
   
  s0 -> s0 {
  guard 
    P1  < 6 &&
    T1[P1+1] != T0[P0] &&
    T1[P1+1] != T2[P2] &&
    T1[P1+1] != T3[P3] &&
    T1[P1+1] != T4[P4] &&
    T1[P1+1] != T5[P5] &&
    T1[P1+1] != T6[P6] &&
    T1[P1+1] != T7[P7] &&
    RA + A1[P1+1] <= LA &&
    RB + B1[P1+1] <= LB;
  sync move1!;
  assign
	P1 := P1+1, 
    RA := RA + A1[P1],
    RB := RB + B1[P1];
  },
   
  s0 -> s0 {
  guard 
    P2 < 6 &&
    T2[P2+1] != T0[P0] &&
    T2[P2+1] != T1[P1] &&
    T2[P2+1] != T3[P3] &&
    T2[P2+1] != T4[P4] &&
    T2[P2+1] != T5[P5] &&
    T2[P2+1] != T6[P6] &&
    T2[P2+1] != T7[P7] &&
    RA + A2[P2+1] <= LA &&
    RB + B2[P2+1] <= LB;
  sync move2!;
  assign
    P2 := P2+1, 
    RA := RA + A2[P2],
    RB := RB + B2[P2];
  },
   
  s0 -> s0 {
  guard 
    P3 < 6 &&
    T3[P3+1] != T0[P0] &&
    T3[P3+1] != T2[P2] &&
    T3[P3+1] != T1[P1] &&
    T3[P3+1] != T4[P4] &&
    T3[P3+1] != T5[P5] &&
    T3[P3+1] != T6[P6] &&
    T3[P3+1] != T7[P7] &&
    RA + A3[P3+1] <= LA &&
    RB + B3[P3+1] <= LB;
  sync move3!;
  assign
    P3 := P3+1, 
    RA := RA + A3[P3],
    RB := RB + B3[P3];
  },
   
  s0 -> s0 {
  guard 
    P4 < 6 &&
    T4[P4+1] != T0[P0] &&
    T4[P4+1] != T1[P1] &&
    T4[P4+1] != T2[P2] &&
    T4[P4+1] != T3[P3] &&
    T4[P4+1] != T5[P5] &&
    T4[P4+1] != T6[P6] &&
    T4[P4+1] != T7[P7] &&
    RA + A4[P4+1] <= LA &&
    RB + B4[P4+1] <= LB;
  sync move4!;
  assign
    P4 := P4+1, 
    RA := RA + A4[P4],
    RB := RB + B4[P4];
  },

  s0 -> s0 {
  guard 
    P5 < 6 &&
    T5[P5+1] != T0[P0] &&
    T5[P5+1] != T1[P1] &&
    T5[P5+1] != T2[P2] &&
    T5[P5+1] != T3[P3] &&
    T5[P5+1] != T4[P4] &&
    T5[P5+1] != T6[P6] &&
    T5[P5+1] != T7[P7] &&
    RA + A5[P5+1] <= LA &&
    RB + B5[P5+1] <= LB;
  sync move5!;
  assign
    P5 := P5+1, 
    RA := RA + A5[P5],
    RB := RB + B5[P5];
  },
  
  s0 -> s0 {
  guard 
    P6 < 6 &&
    T6[P6+1] != T0[P0] &&
    T6[P6+1] != T1[P1] &&
    T6[P6+1] != T2[P2] &&
    T6[P6+1] != T3[P3] &&
    T6[P6+1] != T4[P4] &&
    T6[P6+1] != T5[P5] &&
    T6[P6+1] != T7[P7] &&
    RA + A6[P6+1] <= LA &&
    RB + B6[P6+1] <= LB;
  sync move6!;
  assign
    P6 := P6+1, 
    RA := RA + A6[P6],
    RB := RB + B6[P6];
  },

  s0 -> s0 {
  guard 
    P7 < 6 &&
    T7[P7+1] != T0[P0] &&
    T7[P7+1] != T1[P1] &&
    T7[P7+1] != T2[P2] &&
    T7[P7+1] != T3[P3] &&
    T7[P7+1] != T4[P4] &&
    T7[P7+1] != T5[P5] &&
    T7[P7+1] != T6[P6] &&
    RA + A7[P7+1] <= LA &&
    RB + B7[P7+1] <= LB;
  sync move7!;
  assign
    P7 := P7+1, 
    RA := RA + A7[P7],
    RB := RB + B7[P7];
  };
}

// template instantiations
// List one or more processes to be composed into a system.
system Uppaal_Model;

// ./verifyta -h
// ./verifyta uppaal_oneway8seq.ta uppaal_queries.txt
//
// file:  uppaal_queries.txt
// A<>((P0==6) and (P1==6)and (P2==6)and (P3==6) and
//     (P4==6) and (P5==6)and (P6==6)and (P7==6))
\end{verbatim}
}