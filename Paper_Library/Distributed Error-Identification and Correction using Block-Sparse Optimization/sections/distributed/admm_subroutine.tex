\begin{algorithm}[tb]
    \caption{ADMM Subroutine (at agent $i$)}
    \label{alg:inner}
    \begin{algorithmic}[1]
    % \Require $\lbrace\mathbf z[l],  \mathbf R[l,j], \boldsymbol{\lambda}_i^{(l)}, \boldsymbol{\mu}_i^{(j)}\rbrace_{l\in\mathcal E_i, j\in\mathcal N_i}$, $\mathbf x^*[i]$.  \vspace{3pt}
    
    \State Initialize $\bar {\mathbf w}_i^{(j)}\in\mathbb R^{n_i}$ and $\bar {\mathbf w}_j^{(i)}\in\mathbb R^{n_j}$ as $\mathbf 0$, $\forall j\in\mathcal N_i$. 
%
\vspace{3pt}
\For{$N_{\textrm{ADMM}}$ iterations,}
% \State Communicate \ $\boldsymbol \mu_i^{(j)}$ to agent $j$, $\forall j \in \mathcal N_i$.
\State Let $\bar {\mathbf x}[i]$ be the minimizer of
\begin{align*}
\qquad \qquad &\underset{\ 
 \scalebox{0.9}{$\hat{\mathbf x}[i]$}
 }{\textrm{minimize}}
    \ 
    % \Big[
    \bigl\|\mathbf x^*[i]+\hat{\mathbf x}[i]\bigr\|
    \\
    & +\sum_{l\in\mathcal E_i} 
    \left(
        \frac{\rho}{2}\bigl\|\mathbf c_i^{(l)}(\hat {\mathbf x}, \bar{\mathbf w})\bigr\|^2 + \boldsymbol{\lambda}_i^{(l)
        \raisebox{2pt}{$\scriptstyle\top$}
        }
        \mathbf c_i^{(l)} (\hat {\mathbf x}, \bar{\mathbf w})
    \right)
    \\
    &+
    \sum_{j\in\mathcal N_i} 
    \left( \frac{\rho}{2}\bigl\|
        \mathbf d_i^{(j)}(\hat {\mathbf x}, \bar{\mathbf w})
        \bigr\|^2 + \boldsymbol{\mu}_i^{(j)
        \raisebox{2pt}{$\scriptstyle\top$}
        }
        \mathbf d_i^{(j)}(\hat {\mathbf x}, \bar{\mathbf w})
    \right)
    % \Big]
\end{align*}
\State Communicate $\bar {\mathbf x}[i]$ and $\boldsymbol{\mu}_i^{(j)}$ to agent $j$, $\forall j \in \mathcal N_i$.
\State Let $\lbrace \bar {\mathbf w}_j^{(i)}  |\hsp j\in\mathcal N_i\rbrace$ be the minimizer of
\begin{align*}
 \qquad \qquad &\underset{\ 
 \scalebox{0.85}{$\lbrace\hat{\mathbf w}_j^{(i)}
 | \hsp j\in \mathcal N_i \rbrace$}}{\textrm{minimize}}
    \ 
    % \Big[
    \bigl\|\mathbf x^*[i]+\bar{\mathbf x}[i]\bigr\|
    \\
    & +\sum_{l\in\mathcal E_i} 
    \left(
        \frac{\rho}{2}\bigl\|\mathbf c_i^{(l)}(\bar {\mathbf x}, \hat{\mathbf w})\bigr\|^2 + \boldsymbol{\lambda}_i^{(l)
        \raisebox{2pt}{$\scriptstyle\top$}
        }
        \mathbf c_i^{(l)} (\bar {\mathbf x}, \hat{\mathbf w})
    \right)
    \\
    &+
    \sum_{j\in\mathcal N_i} 
    \left( \frac{\rho}{2}\bigl\|
        \mathbf d_j^{(i)}(\bar {\mathbf x}, \hat{\mathbf w})
        \bigr\|^2 + \boldsymbol{\mu}_j^{(i)
        \raisebox{2pt}{$\scriptstyle\top$}
        }
        \mathbf d_j^{(i)}(\bar {\mathbf x}, \hat{\mathbf w})
    \right)
    % \Big]
\end{align*}
\State Communicate $\bar{\mathbf w}_j^{(i)}$ to agent $j$, $\forall j \in \mathcal N_i$.
\State Update the dual variables, $\forall j\in\mathcal N_i, l\in\mathcal E_i$:
\begin{align}
\boldsymbol \lambda_i^{(l)^+} &\leftarrow \boldsymbol \lambda_i^{(l)} + \rho \hsp \mathbf c_i^{(l)}(\bar {\mathbf x}, \bar{\mathbf w})\\
\boldsymbol \mu_i^{(j)^+} &\leftarrow \boldsymbol \mu_i^{(j)} + \rho \hsp \mathbf d_i^{(j)}(\bar {\mathbf x}, \bar{\mathbf w})
\end{align}
\EndFor \State \Return An approximate solution to the linearized sub-problem, $\lbrace \bar{\mathbf x}[j] \rbrace_{j\in\mathcal N'_i}$.
    \end{algorithmic}
\end{algorithm}