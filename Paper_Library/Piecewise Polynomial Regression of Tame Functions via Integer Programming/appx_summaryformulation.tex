In this section, we provide the complete affine-hyperplane regression formulation, introduced in \Cref{sec:mip-form}.

\begin{subequations}
  % \ifIsArxivVersion
  % \else
  %   \tiny
  % \fi
  \label{eq:OrtFormulationHplane}
  \begin{align}
    \min \; & \frac{1}{\nSample} \sum^{\nSample}_{i=1} \delta_i & \\
    \textrm{s.t.} \quad & \delta_i \ge \phi_{it} - (1 - z_{it})M && \forall i \in [\nSample], \quad \forall t \in \mathcal{T}_L \\
            & \delta_i \ge - \phi_{it} - (1 - z_{it})M && \forall i \in [\nSample], \quad \forall t \in \mathcal{T}_L \\
            & \phi_{it} = y_i - \textrm{poly}(x_i; c_t) && \forall i \in [\nSample], \quad \forall t \in \mathcal{T}_L \\
            & a_m^{\top} x_i \ge b_m - 2(1 - z_{it}) && \forall i \in [\nSample], \quad \forall t \in \mathcal{T}_L, \quad \forall m \in A_R(t) \label{eq:eee}\\
            & a_m^{\top} x_i + \mu \le b_m & & \notag \\
            & \qquad + (2 + \mu)(1 - z_{it})& & \forall i \in [\nSample], \quad \forall t \in \mathcal{T}_L, \quad \forall m \in A_L(t) \label{eq:fff}\\
            & \textstyle\sum_{t \in \mathcal{T}_L}{z_{it}} = 1 && \forall i \in [\nSample]  \label{eq:ggg}\\
            & z_{it} \le l_t && \forall i \in [\nSample], \quad \forall t \in \mathcal{T}_L \label{eq:hhh}\\
            & \textstyle\sum_{i=1}^{\nSample}{z_{it}} \ge N_{\min} l_t && \forall t \in \mathcal{T}_L \label{eq:iii}\\
      & \textstyle\sum_{j=1}^d{(a^+_{jt}+a^-_{jt})} = 1 && \forall t \in \mathcal{T}_B \\
      & a_{jt} = a^+_{jt} - a^-_{jt} && \forall j \in [d], \quad \forall t \in \mathcal{T}_B \\
      & a^+_{jt} \le o_{jt} && \forall j \in [d], \quad \forall t \in \mathcal{T}_B \\
      & a^-_{jt} \le (1 - o_{jt}) && \forall j \in [d], \quad \forall t \in \mathcal{T}_B \\
            % & \textstyle\sum_{j=1}^d{a_{jt}} = 1 && \forall t \in \mathcal{T}_B \label{eq:ccc}\\
            % & 0 \le b_t \le 1 && \forall t \in \mathcal{T}_B \label{eq:ddd}\\
            & z_{it}, l_{t} \in \{0, 1\} && \forall i \in [\nSample], \quad \forall t \in \mathcal{T}_L \\
            & o_{jt} \in \{0, 1\} && \forall j \in [\ndim], \quad \forall t \in \mathcal{T}_B \\
            & a_{jt}, b_{t} \in [-1, 1] && \forall j \in [\ndim], \quad \forall t \in \mathcal{T}_B \\
            & a_{jt}^{+}, a_{jt}^{-} \in [0, 1] && \forall j \in [\ndim], \quad \forall t \in \mathcal{T}_B \\
            & \phi_{it} \in \mathbb{R} && \forall i \in [\nSample], \quad \forall t \in \mathcal{T}_L
  \end{align}
\end{subequations}
The constraints \cref{eq:eee,eq:fff,eq:ggg,eq:hhh,eq:iii} are the optimal classification tree with hyperplanes (OCT-H) of \citet{bertsimasOptimalClassificationTrees2017}; the other constraints are our extension thereof.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main_neurips"
%%% End:
