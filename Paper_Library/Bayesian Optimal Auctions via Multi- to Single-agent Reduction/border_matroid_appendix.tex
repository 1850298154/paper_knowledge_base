\section{Proofs from Section~\ref{sec:border_matroid}}

\begin{proof}[Proof of \autoref{lem:g_k}]
Assuming that agents are independent (i.e., assuming $\DistProbs(\cdot)$ is a product distribution), $\DistOracle_k(\TypeSubset)$
can be computed in time $O((n+\Abs{\TypeSubset})\cdot k)$ using the following dynamic program in which
$\DistDP{i}{j}{\TypeSubset}$ denotes the probability of the event that $\min(\Abs{\Types \cap \TypeSubset \cap
\TypeSpace_{\Range{1}{i}}}, k)=j$.
\begin{align*}
    \DistOracle_k(\TypeSubset) &= \sum_{j=1}^k j\cdot \DistDP{n}{j}{\TypeSubset} \\
    \DistDP{i}{j}{\TypeSubset} &=
        \begin{cases}
            \DistDP{i-1}{k}{\TypeSubset}+(\sum_{\Type_i \in \TypeSubset \cap \TypeSpace_i} \DistProb_i(\Type_i))
                \cdot \DistDP{i-1}{k-1}{\TypeSubset} &  1 \le i \le n, j = k\\
            \DistDP{i-1}{j}{\TypeSubset}+(\sum_{\Type_i \in \TypeSubset \cap \TypeSpace_i} \DistProb_i(\Type_i))
                \cdot (\DistDP{i-1}{j-1}{\TypeSubset}-\DistDP{i-1}{j}{\TypeSubset}) & 1 \le i \le n, 0 \le j < k\\
            1 & i = 0, j = 0 \\
            0 & \text{otherwise}
        \end{cases} \\
\end{align*}
\end{proof}

%???EDITING HERE.

\if 0

\begin{lemma}
\label{lem:closed}%
Consider an arbitrary $\PreAlloc \in \PreAllocSpace$; the tight sets (with respect to $\PreAlloc$) are closed under union and
intersection.
\end{lemma}
\begin{proof}
The proof is standard. We present it for completeness. Define $h(\TypeSubset)=\DistOracle_k(\TypeSubset)-\PreAlloc(\TypeSubset)$.
Suppose $\TypeSubset$ and $\TypeSubset'$ are both tight with respect to $\PreAlloc$, so  $h(\TypeSubset)=h(\TypeSubset')=0$.
Observe that $h(\cdot)$ is non-negative and submodular (because $\DistOracle_k(\cdot)$ is submodular), so
\begin{align*}
    0 \le h(\TypeSubset \cap \TypeSubset')+h(\TypeSubset \cup \TypeSubset') \le h(\TypeSubset)+h(\TypeSubset')=0
\end{align*}
So $h(\TypeSubset \cap \TypeSubset')=h(\TypeSubset \cup \TypeSubset')=0$ which proves the lemma.
\end{proof}



\begin{lemma}
\label{lem:round_in}%
Consider an arbitrary $\PreAlloc \in \PreAllocSpace$ and any two tight sets $\TypeSubset, \TypeSubset''$ (with respect to
$\PreAlloc$) such that $\TypeSubset \subset \TypeSubset'' \subseteq \{\TypeVar | \PreAlloc(\TypeVar) > 0\}$. If there exist
distinct $a, b \in \TypeSubset'' \setminus \TypeSubset$, we can find (in strongly polynomial time) $\delta_{ab} \in [0,1]$, such
that $\PreAlloc'=(\PreAlloc+\delta_{ab}\cdot(\IVec{a}-\IVec{b}))$ is in $\PreAllocSpace$ and satisfies
    \begin{itemize}
    \item either $\PreAlloc'(b)=0$,
    \item or there exists a tight set $\TypeSubset'$ (with respect to $\PreAlloc'$), such that $\TypeSubset \subset
    \TypeSubset' \subset \TypeSubset''$.
    \end{itemize}
\end{lemma}

\begin{proof}
Consider the following experiment. Start from $\delta=0$, increase it continuously, while setting $\PreAlloc'$ to be
$\PreAlloc+\delta\cdot(\IVec{a}-\IVec{b})$. The vector $\PreAlloc'$ is going to be feasible as long as $\PreAlloc'(b)\geq 0$ and
no new set
%$\TypeSubset'$
becomes tight. Notice that since $\PreAlloc(a)+\PreAlloc(b)=\PreAlloc'(a)+\PreAlloc'(b)$, the only sets for which we have
$\PreAlloc(\TypeSubset')\neq \PreAlloc'(\TypeSubset')$ are the those that contain~$a$ but not~$b$.
%$\TypeSubset'$ such that $a\in \TypeSubset'$ and $b\notin \TypeSubset'$.
Thus, the only sets that may get tight as $\delta$ increases are those minimizing
%the sets in $\arg\min_{\TypeSubset':a\in \TypeSubset', b\notin \TypeSubset'}
$\DistOracle_k(\TypeSubset')-\PreAlloc(\TypeSubset')$ among sets containing $a$ and not~$b$.  Let $\TypeSubset^*$ be such a set
and let $\lambda'$ be $\DistOracle_k(\TypeSubset^*) - \PreAlloc(\TypeSubset^*)$.
%Set $\lambda'$ to be $\min_{\TypeSubset':a\in \TypeSubset', b\notin \TypeSubset'} \DistOracle_k(\TypeSubset')-\PreAlloc(\TypeSubset')$.
%Now consider two cases.
Then either $\PreAlloc(b)\leq \lambda'$, in which case we set $\delta_{ab}=\PreAlloc(b)$ and
%have $\PreAlloc'$
satisfy the first bullet; or $\PreAlloc(b)> \lambda'$, in which case we set $\delta_{ab} = \lambda'$ and make $\TypeSubset^*$
tight.
%which makes the sets in $\arg\min_{\TypeSubset':a\in \TypeSubset', b\notin \TypeSubset'} \DistOracle_k(\TypeSubset')-\PreAlloc(\TypeSubset')$ tight.
%We now need to show that by doing this, there will be a tight set $\TypeSubset'$ for which $\TypeSubset \subseteq \TypeSubset' \subseteq \TypeSubset''$. Take any $\TypeSubset^* \in \arg\min_{\TypeSubset':a\in \TypeSubset', b\notin \TypeSubset'} \DistOracle_k(\TypeSubset')-\PreAlloc(\TypeSubset')$. This set must be tight in $\PreAlloc'$. Define
In the second case, observe that the set $\TypeSubset' = \TypeSubset \cup (\TypeSubset^*\cap \TypeSubset'')$ is also tight by
Lemma~\ref{lem:closed}.  We have $\TypeSubset \subset \TypeSubset' \subset \TypeSubset''$, and the second bullet is satisfied.
%Now this set satisfies $\TypeSubset\subseteq \TypeSubset'\subseteq \TypeSubset''$, and by \autoref{lem:closed} it is tight. It only remains to show that such a set (and the value of $\lambda'$) can be found in strongly polynomial time. Notice that such sets are solutions to
Since $\TypeSubset'$ is a solution to the submodular minimization problem $\min_{\TypeSubset': \TypeSubset \subseteq \TypeSubset'
\subseteq \TypeSubset''} \DistOracle_k(\TypeSubset')-\PreAlloc(\TypeSubset')$, it (and hence $\delta_{ab}$) can be found in
strongly polynomial time.

%More precisely, $\delta_{ab}=\min(\PreAlloc(b), \delta')$ where
%    \begin{align*}
%        \delta' & =1 - \left(\min_{\TightSet } \DistOracle_k(\TightSet)-\PreAlloc_{ab}(\TightSet)\right), \qquad \text{where} \;
%        \PreAlloc_{ab}=\PreAlloc+\IVec{a}-\IVec{b} \\
%    \intertext{and}
%        \TightSet \leftarrow (\TightSet' \cup \TightSetIn) \cap \TightSetOut
%    \end{align*}
\end{proof}

\begin{lemma}
\label{lem:round_out}%
Consider an arbitrary $\PreAlloc \in \PreAllocSpace$ and any tight set $\TypeSubset$ (with respect to $\PreAlloc$) such that
$\TypeSubset \subseteq \{\TypeVar | \PreAlloc(\TypeVar) > 0\}$. If there exists $c \in \UnionTypeSpace \setminus \TypeSubset$ for
which $\PreAlloc(c) > 0$, we can find in strongly polynomial time $\delta^+ \in [0,1]$, such that
$\PreAlloc'=(\PreAlloc+\delta^+\cdot\IVec{c})$ is in~$\PreAllocSpace$, and there exists a tight set $\TypeSubset'$ (with respect
to $\PreAlloc'$) where $\TypeSubset' \supset \TypeSubset$.
\end{lemma}
\begin{proof}
Again consider the following experiment. Start from $\delta = 0$, increase it continuously while setting $\PreAlloc'(c)$ to be
$\PreAlloc(c) + \delta \cdot \IVec{c}$.  Consider a set $S^*$ that first becomes tight in $\PreAlloc'$. Notice that $\TypeSubset$
is still tight in $\PreAlloc'$. Therefore, by Lemma~\ref{lem:closed}, $\TypeSubset' = \TypeSubset \cup \TypeSubset^*$ is a tight
set,
%and by definition $\TypeSubset \subseteq \TypeSubset'$. In fact,
and since $c\notin \TypeSubset$ and $c\in \TypeSubset'$, we have $\TypeSubset \subset \TypeSubset'$.


%More precisely, $\delta_{ab}=\min(\PreAlloc(b), \delta')$ where
%    \begin{align*}
%        \delta' & =1 - \left(\min_{\TightSet } \DistOracle_k(\TightSet)-\PreAlloc_{ab}(\TightSet)\right), \qquad \text{where} \;
%        \PreAlloc_{ab}=\PreAlloc+\IVec{a}-\IVec{b} \\
%    \intertext{and}
%        \TightSet \leftarrow (\TightSet' \cup \TightSetIn) \cap \TightSetOut
%    \end{align*}
\end{proof}

\fi
