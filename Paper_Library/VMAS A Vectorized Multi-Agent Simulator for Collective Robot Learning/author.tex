%%%%%%%%%%%%%%%%%%%% author.tex %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% sample root file for your "contribution" to a proceedings volume
%
% Use this file as a template for your own input.
%
%%%%%%%%%%%%%%%% Springer %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\documentclass{svproc}
%
% RECOMMENDED %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%

% to typeset URLs, URIs, and DOIs
\usepackage{url}
\def\UrlFont{\rmfamily}
\usepackage{newtxtext}       % 
\usepackage[varvw]{newtxmath}       % selects Times Roman as basic font

\usepackage[font=small,labelfont=bf]{caption}
\usepackage{subcaption}

%\hypersetup{hidelinks}
\usepackage[export]{adjustbox}
\usepackage{booktabs}
\usepackage[utf8]{inputenc}
\usepackage{pgfplots}
\usepackage{tikz,tikzscale}
\usepackage{adjustbox}
\usepackage{svg}
\usepackage{pifont}% http://ctan.org/pkg/pifont
\usepackage{footmisc}
\usepackage{hyperref}

\newcommand{\R}{\mathbb{R}}

\newcommand{\fixit}[1]{\textcolor{red}{\textbf{#1}}}
\newcommand{\removable}[1]{\textcolor{blue}{\textbf{#1}}}
\newcommand{\matteo}[1]{\sethlcolor{green}\hl{[Matteo: #1]}}
\newcommand{\jan}[1]{\textcolor{olive}{#1}}
\newcommand{\amanda}[1]{\textcolor{blue}{\textbf{#1}}}

\DeclareUnicodeCharacter{2212}{−}
\usepgfplotslibrary{groupplots,dateplot}
\usetikzlibrary{patterns,shapes.arrows}
\pgfplotsset{compat=newest}
\newcommand{\lilskip}[0]{\vspace{0.15cm}}
\newcommand{\mylittleskip}{\vspace{0.2cm}}
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%

%\linespread{1.0}

\renewcommand{\tableautorefname}{Tab.}
\renewcommand{\equationautorefname}{Eq.}
\renewcommand{\figureautorefname}{Fig.}
\renewcommand{\sectionautorefname}{Sec.}
\renewcommand{\subsectionautorefname}{Sec.}


\begin{document}
\mainmatter              % start of a contribution
%
\title{VMAS: A Vectorized Multi-Agent Simulator for Collective Robot Learning}
%
\titlerunning{VMAS: A Vectorized Multi-Agent Simulator for Collective Robot Learning}  % abbreviated title (for running head)
%                                     also used for the TOC unless
%                                     \toctitle is used
%
\author{Matteo Bettini \and Ryan Kortvelesy \and Jan Blumenkamp \and Amanda Prorok}
%
\authorrunning{Matteo Bettini et al.} % abbreviated author list (for running head)
%
%%%% list of authors for the TOC (use if author list has to be modified)
\tocauthor{Matteo Bettini, Ryan Kortvelesy, Jan Blumenkamp and Amanda Prorok}
%
\institute{Department of
Computer Science and Technology, University of Cambridge, Cambridge, UK, \email{\{mb2389,rk627,jb2270,asp45\}@cl.cam.ac.uk}}

\maketitle              % typeset the title of the contribution

\begin{abstract}
While many multi-robot coordination problems can be solved optimally by exact algorithms, solutions are often not scalable in the number of robots. Multi-Agent Reinforcement Learning (MARL) is gaining increasing attention in the robotics community as a promising solution to tackle such problems. Nevertheless, we still lack the tools that allow us to \textit{quickly} and \textit{efficiently} find solutions to large-scale collective learning tasks. In this work, we introduce the Vectorized Multi-Agent Simulator (VMAS). VMAS is an open-source framework designed for efficient MARL benchmarking. It is comprised of a vectorized 2D physics engine written in PyTorch and a set of twelve challenging multi-robot scenarios. Additional scenarios can be implemented through a simple and modular interface. We demonstrate how vectorization enables parallel simulation on accelerated hardware without added complexity. When comparing VMAS to OpenAI MPE, we show how MPE's execution time increases linearly in the number of simulations while VMAS is able to execute 30,000 parallel simulations in under 10s, proving more than 100$\times$ faster. Using VMAS's RLlib interface, we benchmark our multi-robot scenarios using various Proximal Policy Optimization (PPO)-based MARL algorithms. VMAS's scenarios prove challenging in orthogonal ways for state-of-the-art MARL algorithms. The VMAS framework is available at: \url{https://github.com/proroklab/VectorizedMultiAgentSimulator}. A video of VMAS scenarios and experiments is available \href{https://youtu.be/aaDRYfiesAY}{here}\footnote{\url{https://youtu.be/aaDRYfiesAY} \label{foot:video}}
\keywords{simulator, multi-robot learning, vectorization}
\end{abstract}

\begin{figure}[ht]
    \newcommand{\subfigsize}{0.25}
     \centering
       \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/transport.pdf}
         \caption{Transport}
         \label{fig:transport}
     \end{subfigure}%
          \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/wheel.pdf}
         \caption{Wheel}
         \label{fig:wheel}
     \end{subfigure}%
     \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/balance.pdf}
         \caption{Balance}
         \label{fig:balance}
     \end{subfigure}%
       \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/give_way.pdf}
         \caption{Give way}
         \label{fig:give_way}
     \end{subfigure}
    \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/football.pdf}
         \caption{Football}
         \label{fig:football}
     \end{subfigure}%
     \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/passage.pdf}
         \caption{Passage}
         \label{fig:passage}
     \end{subfigure}%
     \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/reverse_transport.pdf}
         \caption{Reverse Transport}
         \label{fig:reverse_transport}
     \end{subfigure}%
     \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/dispersion.pdf}
         \caption{Dispersion}
         \label{fig:dispersion}
     \end{subfigure}
    
     \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/dropout.pdf}
         \caption{Dropout}
         \label{fig:dropout}
     \end{subfigure}%
     \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/flocking.pdf}
         \caption{Flocking}
         \label{fig:flocking}
     \end{subfigure}%
     \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/discovery.pdf}
         \caption{Discovery}
         \label{fig:discovery}
     \end{subfigure}%
     \begin{subfigure}{\subfigsize\linewidth}
         \centering
         \includegraphics[width=\linewidth,frame]{figures/scenarios/waterfall.pdf}
         \caption{Waterfall}
         \label{fig:waterfall}
     \end{subfigure}%
    \caption{Multi-robot scenarios introduced in VMAS. Robots (blue shapes) interact among each other and with landmarks (green, red, and black shapes) to solve a task.}
    \label{fig:vmaps_scenarios}
\end{figure}

\section{Introduction}
\label{sec:introduction}
\input{sections/introduction}
\section{Related work}
\label{sec:related_work}
\input{sections/related_works}
\section{The VMAS platform}
\label{sec:simulator}
\input{sections/simulator}
\section{Multi-robot scenarios}
\label{sec:scenarios}
\input{sections/scenarios}
\section{Comparison with MPE}
\label{sec:mpe_comparison}
\input{sections/mpe_comparison}
\section{Experiments and benchmarks}
\label{sec:experiments}
\input{sections/experiments}
\section{Conclusion}
\label{sec:conclusion}
\input{sections/conclusion}
\section*{Acknowledgements}
This work was supported by ARL DCIST CRA W911NF-17-2-0181 and European Research Council (ERC) Project 949940 (gAIa). R. Kortvelesy was supported by Nokia Bell Labs through their donation for the Centre of Mobile, Wearable Systems and Augmented Intelligence to the University of Cambridge. J. Blumenkamp acknowledges the support of the ‘Studienstiftung des deutschen Volkes’ and an EPSRC tuition fee grant.


\bibliographystyle{spmpsci} 
\bibliography{bibliography}

\end{document}
