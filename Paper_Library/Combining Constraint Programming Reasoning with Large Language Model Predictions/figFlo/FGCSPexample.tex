

\begin{figure}
    \centering
    % \scalebox{0.95}{
    \scalebox{1}{
    \scriptsize
    % \begin{tikzpicture}[every node/.style={noeud, text width=12mm, align=center, inner sep=0pt}]
    \begin{tikzpicture}[every node/.style={noeud, align=center, inner sep=0pt}]

        % \onslide<1-1>{

        %     \node[ellipse, color=cyan] (1) at (0, 0) {Initial\\State};
        %     \draw[arc, color = cyan] (1.north west) ++ (-0.4, 0.4) -- (1);

        % }

        % \onslide<2->{

        %     \node[ellipse] (1) at (0, 0) {Initial\\State};
        %     \draw[arc] (1.north west) ++ (-0.4, 0.4) -- (1);

        % }

        
        % \onslide<2->{
        %     \node[ellipse, color=cyan] (2) at (3, 0) {Save\\State};
        %     % {Run\\Propagation};
        %     \draw [arc, color=cyan] (1) edge[bend left] node[draw=none, above]{$\neq \emptyset$} (2);

        %     \node[ellipse, color=cyan] (5) at (0, -2) {Generative\\Function};
        %     \draw [arc, color=cyan] (5) -- (2);
        %     \draw [arc, color=cyan] (1) -- node[draw=none, right]{$= \emptyset$} (5);
        % }

        % \onslide<3->{
        %     \node[ellipse] (2) at (3, 0) {Save\\State};
        %     \draw [arc] (1) edge[bend left] node[draw=none, above]{$\neq \emptyset$} (2);

        %     \node[ellipse] (5) at (0, -2) {Generative\\Function};
        %     \draw [arc] (5) -- (2);
        %     \draw [arc] (1) -- node[draw=none, right]{$= \emptyset$} (5);
        % }

        
        % \onslide<3->{
        %     \node[ellipse, color=cyan] (3) at (3, -2) {Run\\Propagation};
        %     \draw [arc, color=cyan] (2) -- (3);

        %     \node[draw=none] (be) at (9, -2) {Propagation:\\remove values of variables\\that do not satisfy\\the constraints};
        % }

        % \onslide<4->{
        %     \node[ellipse] (3) at (3, -2) {Run\\Propagation};
        %     \draw [arc] (2) -- (3);

        %     \node[draw=none] (be) at (9, -2) {Propagation:\\remove values of variables\\that do not satisfy\\the constraints};
        % }

        % \onslide<4->{
        %     \node[ellipse, color=cyan] (8) at (6, 0) {Backtrack};
        %     \draw [arc, color=cyan] (8) edge[bend right] (2);
        %     \draw [arc, color=cyan] (3) edge[bend right] node[draw=none, above left]{fail} (8);

        %     \node[draw=none] (be) at (9, -3.9) {Backtrack:\\return to a previous\\saved state};
        % }
        
        % \onslide<5->{
        %     \node[ellipse] (8) at (6, 0) {Backtrack};
        %     \draw [arc] (8) edge[bend right] (2);
        %     \draw [arc] (3) edge[bend right] node[draw=none, above left]{fail} (8);

        %     \node[draw=none] (be) at (9, -3.9) {Backtrack:\\return to a previous\\saved state};            
        % }


        % \onslide<5->{
        %     \node[ellipse, color=cyan] (4) at (3, -4) {Solution\\Found ?};
        %     \draw [arc, color=cyan] (3) -- (4);
        %     \draw[arc, color=cyan] (4) edge[bend left] node[draw=none, above]{no} (5);
        % }

        % \onslide<6->{
        %     \node[ellipse] (4) at (3, -4) {Solution\\Found ?};
        %     \draw [arc] (3) -- (4);
        %     \draw[arc] (4) edge[bend left] node[draw=none, above]{no} (5);
        % }

        % \onslide<6->{
        %     \node[ellipse, color=cyan] (6) at (6, -4) {Save\\Solution};
        %     \draw[arc, color=cyan] (4) edge[bend right] node[draw=none, above]{yes} (6);
        %     \draw [arc, color=cyan] (6) -- (8);
        % }


        % \onslide<7->{
        
        %     \node[ellipse] (6) at (6, -4) {Save\\Solution};
        %     \draw[arc] (4) edge[bend right] node[draw=none, above]{yes} (6);
            
        %     \draw [arc] (6) -- (8);

        %     \node[ellipse, color=cyan] (9) at (9, 0) {Return\\Solution(s) Saved};
        %     \node [ellipse, color=cyan, minimum width=35mm, minimum height=10mm] (9b) at (9) {};
        %     \draw [arc, color=cyan] (8) edge[bend left] node[draw=none, above]{fail} (9b);
            
        % }

        \node[ellipse] (1) at (0, 0) {3: Helping\\Functions};

        \node[ellipse] (2) at (3, 0) {4: Save\\State};
        % \draw [arc] (1) edge[bend left] node[draw=none, above]{$\neq \emptyset$} (2);
        % \draw[arc] (1) edge[bend left] (2);
        \draw[arc] (1) edge[bend right] (2);

        \node[ellipse] (5) at (0, -1.5) {2: Generative\\Functions};
        % \draw [arc] (5) -- (2);
        \draw[arc] (5) -- (1);
        % \draw [arc] (1) -- node[draw=none, left]{$= \emptyset$} (5);

        \node[ellipse] (3) at (3, -1.5) {5: Run\\Propagation};
        \draw [arc] (2) -- (3);

        % \node[draw=none] (be) at (9, -2) {Propagation:\\remove values of variables\\that do not satisfy\\the constraints};

        \node[ellipse] (8) at (6, 0) {8: Backtrack};
        % \draw [arc] (8) edge[bend right] (2);
        \draw [arc] (8) edge[bend left] (2);
        \draw [arc] (3) edge[bend right] node[draw=none, below right]{fail} (8);
        % \draw [arc] (1.north west) edge[bend left] (8.north east);

        % \node[draw=none] (be) at (9, -3.9) {Backtrack:\\return to a previous\\saved state\\change};  

        \node[ellipse] (4) at (3, -3) {6: Boolean\\Functions};
        \draw [arc] (3) -- (4);
        % \draw[arc] (4) edge[bend left] node[draw=none, below]{no solution found} (5);
        % \draw [arc] (4) edge[bend left] (5);
        \draw [arc] (4) -- (5);
        % \node[ellipse,draw=none, rotate=-30] (999) at (1.5,-2.4) {no solution found};
        \node[ellipse,draw=none, rotate=-25] (666) at (1.9,-2.1) {no sol found};

        \node[ellipse] (6) at (6, -3) {7: Save\\Solution};
        % \draw[arc] (4) edge[bend right] node[draw=none]{solution found} (6);
        \draw[arc] (4) edge[bend right] (6);
        \node[ellipse,draw=none] (666) at (4.5,-3.75) {solution found};
        
        \draw [arc] (6) -- (8);

        \node[ellipse] (9) at (3, 1.5) {9: Return\\Solution(s) Saved};
        \node [ellipse, minimum width=33mm, minimum height=10mm] (9b) at (9) {};
        % \draw [arc] (8) edge[bend left] node[draw=none, above]{fail} (9b);
        \draw [arc] (8) edge[bend right] node[draw=none, above]{fail} (9b);

        % \node[ellipse] (10) at (1.5, 1) {Call Helping\\Functions};
        % \draw [arc] (5) -- (10);
        % \draw [arc] (10) -- (2);
        %  \draw[arc] (10) edge[bend left] node[draw=none]{fail} (8);

        \node[ellipse] (1b) at (0, -3) {1: Initial\\State};
        % \draw [arc] (1b) -- node[draw=none, left]{$= \emptyset$} (5);
        % \draw [arc] (1b) edge[bend left] (5);
        \draw [arc] (1b) -- node[draw=none, right]{empty} (5);
        \draw [arc] (1b) edge[bend left = 65] (1);
        % \draw[arc] (1b.north west) ++ (-0.4, 0.4) -- (1b);
        \draw[arc] (1b.south west) ++ (0, -0.4) -- (1b);

        \draw[arc] (1) edge[bend left=20] (8);
        \node[ellipse,draw=none] (333) at (1, 0.6) {fail};
        % \draw[->, thick, > = latex] (1.north) edge[bend left] (8.north east);

        \node[ellipse, color=blue] (llm) at (1.5, -1) {LLM};
        % \draw [arc] (5) -- (2);
        \draw[arc, color=blue] (llm)  edge[bend right] (5);
        \draw[arc, color=blue] (5)  edge[bend right] (llm);
        
        
    \end{tikzpicture}}
    \caption{This graph illustrates the main steps in GenCP solving.}
    \label{fig:fgcsp}
\end{figure}


