%!TEX root = main.tex

% Input: trace tr, ad a deadlock pattern D = <e0, e1, .., ek>,

% SPClosure(tr, S):
% 	closure = emptyset
% 	while closure changes:

\small
%\setlength{\textfloatsep}{0pt}
\begin{algorithm}[H]
\Input{Trace $\tr$, Timestamp $T_0$}
\BlankLine
% \myfun{\fixpoint{$\sigma$, $T_0$, $\set{\AcqLst_{t,\lk}}_{\lk\in \locks{\tr}, t \in \threads{\tr}}$}}{
	\Let $\set{\AcqLst_{t,\lk}}_{\lk\in \locks{\tr}, t \in \threads{\tr}}$ be the lock-acquisition histories in $\tr$ \;
	$T \gets T_0$ \;
	\Repeat{$T$ does not change}{
		\For{$\lk \in \locks{}$}{
			\ForEach{$t \in \threads{}$}{
				\Let $e_t$ be the last event in $\AcqLst_{t,\lk}$ with $\TS{\tr}^{e_t} \cle T$ \;
				Remove all earlier events in $\AcqLst_{t, \lk}$ 
			}
			\Let $e_{t*}$ be the last event in $\set{e_t}_{t\in \threads{\tr}}$ according to $\trord{\tr}$ \;
			$T$ := $T \mx \bigsqcup \setpred{\TS{\tr}^{\match{\tr}(e_t)}}{e_t \neq e_{t*}}$	\;
		}
	}
	\Return $T$
% }
\caption{CompSPClosure:\\ Computing sync-preserving closure.}
\algolabel{compute-closure}
\end{algorithm}
\normalsize
