%!TEX root = main.tex

\small
\begin{algorithm}[H]
%\Input{Trace $\tr$, Abstract deadlock pattern $\abst{D}$ of length $k$}
\Input{Trace $\tr$, $\abst{D}$ of length $k$}
\BlankLine
	\Let $F_0, \ldots, F_{k-1}$ be the sequences of acquires in $\abst{D}$ \;
	\Let $n_0, \ldots, n_{k-1}$ be the lengths of $F_0, \ldots, F_{k-1}$ \;
	\lForEach{$j \in \set{0, \ldots, k-1}$}{
		$i_j \gets 1$
	}
	$T \gets \lambda t, 0$ %\tcp{Timestamp of sync-preserving closure}
	\While{$\bigwedge\limits_{j=0}^{k-1} i_j < n_j$}{
		\Let $e_0 = F_0[i_0], \ldots, e_{k-1} = F_{k-1}[i_{k-1}]$ \;
		$S \gets \prev{\tr}{\set{e_0, \ldots, e_{k-1}}}$\;
		$T \gets$ \fixpoint{$\tr, T \mx \TS{\tr}^S$}\\   \linelabel{call-comp-closure}
		%\tcp{\algoref{compute-closure}}
		\If{$\forall j < k, \TS{\tr}^{e_{j}} \cle T$}{
			\report pattern $D = e_0, \ldots, e_{k-1}$ and \exit
		}
		\ForEach{$j \in \set{0, \ldots, k-1}$}{
			$i_j = \min\setpred{l \leq n_j}{\TS{\tr}^{F_j[l]} \not\cle T}$ %\tcp{Update index in $F_j$}
		}
	}
\caption{CheckAbsDdlck:\\ Checking an abstract deadlock pattern.}
\algolabel{abstract-pattern}
\end{algorithm}
\normalsize
