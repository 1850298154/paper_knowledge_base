\begin{figure}[tb]
%\resizebox{3.4in}{1.6in}{%
\begin{tikzpicture}[ new set=import nodes]
 \begin{scope}[nodes={set=import nodes}]
      
      
      %%%%%%%%%%%% (a) %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      \node (a) at (-0.35,3) {$(a)$};
      \node (x_Lia)[latent, minimum size=31pt] at (0,0) {$\chi^i_L$};
      \node (x_Lma)[latent,dashed, minimum size=31pt] at (0.5,2.25) {$\chi^m_L$};
      \node (x_Lja)[latent,dashed, minimum size=31pt] at (0.5,-2.25) {$\chi^j_L$};


      %\node [factor, right=of x1, label={$f(x_2|x_1)$}] (f1) {};
     % \node [latent, right=of f1, xshift=-0.55cm] (x2) {$x_2$};
      \node [latent, right=of x_Lia, xshift=0.0cm, minimum size=31pt] (x2_ijma) {$\chi^{ijm}_{C,2}$};
      
      \node [latent, above=of x2_ijma, yshift=-0.5cm, minimum size=31pt] (x2_ima) {$\chi^{im\setminus j}_{C,2}$};
      
      \node [latent, below=of x2_ijma, yshift=0.5cm, minimum size=31pt] (x2_ija) {$\chi^{ij\setminus m}_{C,2}$};
     
     \node [factor,fill=red!100, right=of x2_ijma ] (f2a) {};
     \node [factor,fill=red!100, above=of x_Lia ] (fla) {};
     
     %%%%%%%%%%%% (b) %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      \node (b) at (3.85,3) {$(b)$};
      \node (x_Lib)[latent, minimum size=31pt] at (4.2,0) {$\chi^i_L$};
      \node (x_Lmb)[latent,dashed, minimum size=31pt] at (4.7,2.25) {$\chi^m_L$};
      \node (x_Ljb)[latent,dashed, minimum size=31pt] at (4.7,-2.25) {$\chi^j_L$};


      %\node [factor, right=of x1, label={$f(x_2|x_1)$}] (f1) {};
     % \node [latent, right=of f1, xshift=-0.55cm] (x2) {$x_2$};
      \node [latent, right=of x_Lib, xshift=0.0cm, minimum size=31pt] (x2_ijmb) {$\chi^{ijm}_{C,2}$};
      
      \node [latent, above=of x2_ijmb, yshift=-0.5cm, minimum size=31pt] (x2_imb) {$\chi^{im\setminus j}_{C,2}$};
      
      \node [latent, below=of x2_ijmb, yshift=0.5cm, minimum size=31pt] (x2_ijb) {$\chi^{ij\setminus m}_{C,2}$};
     
     \node [factor,fill=red!100, right=of x2_ijmb ] (f2b) {};
     \node [factor,fill=red!100, above=of x_Lib ] (flb) {};
     
     \node [factor,fill=black!40, between=x_Ljb and x2_ijmb] (f_j11) {};
     \node [factor,fill=black!40, between=x_Ljb and x2_ijb] (f_j21) {};
      
     \node [factor,fill=black!40, between=x_Lmb and x2_ijmb] (f_m11) {};
     \node [factor,fill=black!40, between=x_Lmb and x2_imb] (f_m21) {};
     
     \node [factor, between=x_Lib and x2_imb ] (yi11) {};
     \node [factor, between=x_Lib and x2_ijmb ] (yi21) {};
     \node [factor, between=x_Lib and x2_ijb ] (yi31) {};
     
     %%%%%%%%%%%% (c) %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      
      \node (c) at (-0.35,-3.25) {$(c)$};
      \node (x_Lic)[latent, minimum size=31pt] at (0,-6.25) {$\chi^i_L$};
      \node (x_Lmc)[latent,dashed, minimum size=31pt] at (0.5,-4) {$\chi^m_L$};
      \node (x_Ljc)[latent,dashed, minimum size=31pt] at (0.5,-8.5) {$\chi^j_L$};

      %\node [factor, right=of x1, label={$f(x_2|x_1)$}] (f1) {};
     % \node [latent, right=of f1, xshift=-0.55cm] (x2) {$x_2$};
      \node [latent, right=of x_Lic, xshift=0.0cm, minimum size=31pt] (x2_ijmc) {$\chi^{ijm}_{C,2}$};
      
      \node [latent, above=of x2_ijmc, yshift=-0.5cm, minimum size=31pt] (x2_imc) {$\chi^{im\setminus j}_{C,2}$};
      
      \node [latent, below=of x2_ijmc, yshift=0.5cm, minimum size=31pt] (x2_ijc) {$\chi^{ij\setminus m}_{C,2}$};
     
     \node [factor,fill=red!100, between=x2_ijmc and x2_imc, label=right:\textcolor{red!100}{{$\tilde{f}^{im}_{2}$}} ] (f2c_im) {};
     \node [factor,fill=red!100, between=x2_ijmc and x2_ijc, label=right:\textcolor{red!100}{{$\tilde{f}^{ij}_{2}$}} ] (f2c_ij) {};
     
     \node [factor,fill=red!100, above=of x_Lic ] (flc) {};
     
     %%%%%%%%%%%% (d) %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      \node (d) at (3.85,-3.25) {$(d)$};
      \node (x_Lid)[latent, minimum size=31pt] at (4.2,-6.25) {$\chi^i_L$};
      \node (x_Lmd)[latent,dashed, minimum size=31pt] at (4.7,-4) {$\chi^m_L$};
      \node (x_Ljd)[latent,dashed, minimum size=31pt] at (4.7,-8.5) {$\chi^j_L$};


      %\node [factor, right=of x1, label={$f(x_2|x_1)$}] (f1) {};
     % \node [latent, right=of f1, xshift=-0.55cm] (x2) {$x_2$};
      \node [latent, right=of x_Lid, xshift=0.0cm, minimum size=31pt] (x2_ijmd) {$\chi^{ijm}_{C,2}$};
      
      \node [latent, above=of x2_ijmd, yshift=-0.5cm, minimum size=31pt] (x2_imd) {$\chi^{im\setminus j}_{C,2}$};
      
      \node [latent, below=of x2_ijmd, yshift=0.5cm, minimum size=31pt] (x2_ijd) {$\chi^{ij\setminus m}_{C,2}$};
     
     \node [factor,fill=red!100, between=x2_ijmd and x2_imd, label=right:\textcolor{red!100}{{$\tilde{f}^{im}_{2}$}} ] (f2d_im) {};
     \node [factor,fill=red!100, between=x2_ijmd and x2_ijd, label=right:\textcolor{red!100}{{$\tilde{f}^{ij}_{2}$}} ] (f2d_ij) {};
     
     \node [factor,fill=red!100, above=of x_Lid ] (fld) {};
     
     \node [factor,fill=black!40, between=x_Ljd and x2_ijmd] (f_j11d) {};
     \node [factor,fill=black!40, between=x_Ljd and x2_ijd] (f_j21d) {};
      
     \node [factor,fill=black!40, between=x_Lmd and x2_ijmd] (f_m11d) {};
     \node [factor,fill=black!40, between=x_Lmd and x2_imd] (f_m21d) {};
     
     \node [factor, between=x_Lid and x2_imd ] (yi11d) {};
     \node [factor, between=x_Lid and x2_ijmd ] (yi21d) {};
     \node [factor, between=x_Lid and x2_ijd ] (yi31d) {};
      
  \end{scope}
  
 \graph {
    (import nodes);
   
    % dynamic
    
    %{s3,x3}--f2, s4--[dashed]f2,
   
   % (b)
    
    {x2_ima, x2_ija, x2_ijma }--f2a,
    {x_Lia }--fla,
    
    {x_Lib,x2_ijmb}--yi21,
    {x_Lib,x2_imb}--yi11,
    {x_Lib,x2_ijb}--yi31,
    {x2_imb, x2_ijb, x2_ijmb }--f2b,
    {x_Lmb}--[dashed]f_m21, 
    {x_Lmb}--[dashed]f_m11,
    {x_Ljb}--[dashed]f_j21, 
    {x_Ljb}--[dashed]f_j11,
    {x2_imb}--[dashed]f_m21,
    {x2_ijmb}--[dashed]f_m11,
    {x2_ijb}--[dashed]f_j21, 
    {x2_ijmb}--[dashed]f_j11,
    {x_Lib }--flb,
    
    
    {x2_ijmc, x2_imc}--f2c_im,
    {x2_ijmc, x2_ijc}--f2c_ij,
    {x_Lic }--flc,
    
    {x_Lid,x2_ijmd}--yi21d,
    {x_Lid,x2_imd}--yi11d,
    {x_Lid,x2_ijd}--yi31d,
    {x_Lid }--fld,
  
    {x_Lmd}--[dashed]f_m21d, 
    {x_Lmd}--[dashed]f_m11d,
    {x_Ljd}--[dashed]f_j21d, 
    {x_Ljd}--[dashed]f_j11d,
    {x2_imd}--[dashed]f_m21d,
    {x2_ijmd}--[dashed]f_m11d,
    {x2_ijd}--[dashed]f_j21d, 
    {x2_ijmd}--[dashed]f_j11d,
    {x2_ijmd, x2_imd}--f2d_im,
    {x2_ijmd, x2_ijd}--f2d_ij,
    
    };
    
\end{tikzpicture}
\caption{Visible dependencies with full graph perspective. (a) graph after filtering (b) addition of measurement factors and dependencies at time step 2, red dense factor breaks conditional independence assumption required for heterogeneous fusion. (c)-(d) our proposed method to regain conditional independence by factorizing into smaller local factors.}
      \label{fig:common_vars}
      \vspace{-0.2in}
\end{figure}